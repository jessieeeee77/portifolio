<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Portfolio 10</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Portfolio</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="p01.html">Portfolio 1</a>
</li>
<li>
  <a href="p02.html">Portfolio 2</a>
</li>
<li>
  <a href="p03.html">Portfolio 3</a>
</li>
<li>
  <a href="p04.html">Portfolio 4</a>
</li>
<li>
  <a href="p05.html">Portfolio 5</a>
</li>
<li>
  <a href="p06.html">Portfolio 6</a>
</li>
<li>
  <a href="p07.html">Portfolio 7</a>
</li>
<li>
  <a href="p08.html">Portfolio 8</a>
</li>
<li>
  <a href="p09.html">Portfolio 9</a>
</li>
<li>
  <a href="p10.html">Portfolio 10</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Portfolio 10</h1>

</div>


<blockquote>
<p>The projects should be numbered consecutively (i.e., in the order in
which you began them), and should include for each project a description
of the goal, the product (computer program, hand graph, computer graph,
etc.), the data, and some interpretation. Reports must be reproducible
and of high quality in terms of writing, grammar, presentation, etc.</p>
</blockquote>
<p>#descriptives: #the ten portifolios concentrated on building up
graphs and data analyses for my first year and thesis project. I used
SEM, ggplot, multigroup modeling, t-test, and ANOVA tests, chisq test.
Basically I try to redo the data analyses that I used in SPSS for my
first year project, and then do some data analyses for my thesis. R did
a great job at visualizing the associations and interactions that I
aimed to investigate in my thesis. #the following codes represent the
major task or accomplished goals of each of my portifolio.</p>
<pre class="r"><code>#for the poster presentation, make a graph that show the effect
library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
## ✔ ggplot2 3.4.1     ✔ purrr   1.0.1
## ✔ tibble  3.1.8     ✔ dplyr   1.1.0
## ✔ tidyr   1.3.0     ✔ stringr 1.5.0
## ✔ readr   2.1.4     ✔ forcats 1.0.0
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(dplyr)
library(haven)
Mother_and_teen_data &lt;- read_sav(&quot;Mother_and_teen_data.sav&quot;)
#View(Mother_and_teen_data)
Mother_and_teen_data$Race3 &lt;- as.factor(Mother_and_teen_data$Race3)</code></pre>
<pre class="r"><code>library(tidyverse)
library(dplyr)
library(haven)
mt &lt;- Mother_and_teen_data %&gt;% 
 filter(!is.na(Race3)) %&gt;% 
  mutate(ad_deviance=CD_1 + CD_2 + CD_3)
model1&lt;-&quot;AdolD=~CD_1 +CD_2 +CD_3
EffectP=~PAPmoni+PAPWARM+PAPsolic+PAPrule
PSE~EffectP
AdolD~EffectP + PSE&quot;
#residual correlations
PAPmoni~~PAPsoli</code></pre>
<pre><code>## PAPmoni ~ ~PAPsoli</code></pre>
<pre class="r"><code>PAPmoni~~PAPrule</code></pre>
<pre><code>## PAPmoni ~ ~PAPrule</code></pre>
<pre class="r"><code>PAPWARM~~PAPsoli</code></pre>
<pre><code>## PAPWARM ~ ~PAPsoli</code></pre>
<pre class="r"><code>CD_1~~CD_2</code></pre>
<pre><code>## CD_1 ~ ~CD_2</code></pre>
<pre class="r"><code>CD_1~~CD_3</code></pre>
<pre><code>## CD_1 ~ ~CD_3</code></pre>
<pre class="r"><code>CD_2~~CD_3</code></pre>
<pre><code>## CD_2 ~ ~CD_3</code></pre>
<p>the model fits.</p>
<pre class="r"><code>library(lavaan)</code></pre>
<pre><code>## This is lavaan 0.6-14
## lavaan is FREE software! Please report any bugs.</code></pre>
<pre class="r"><code>library(readxl)
library(dplyr)
library(haven)
teendata&lt;- Mother_and_teen_data %&gt;% filter( !is.na(PerPW)) 
fit1&lt;- sem(model1, data=Mother_and_teen_data)
fit1</code></pre>
<pre><code>## lavaan 0.6.14 ended normally after 36 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        18
## 
##                                                   Used       Total
##   Number of observations                           132         184
## 
## Model Test User Model:
##                                                       
##   Test statistic                                29.756
##   Degrees of freedom                                18
##   P-value (Chi-square)                           0.040</code></pre>
<pre class="r"><code>summary(fit1, standardized=TRUE, ci=TRUE, fit.measures=TRUE)</code></pre>
<pre><code>## lavaan 0.6.14 ended normally after 36 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        18
## 
##                                                   Used       Total
##   Number of observations                           132         184
## 
## Model Test User Model:
##                                                       
##   Test statistic                                29.756
##   Degrees of freedom                                18
##   P-value (Chi-square)                           0.040
## 
## Model Test Baseline Model:
## 
##   Test statistic                               306.486
##   Degrees of freedom                                28
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    0.958
##   Tucker-Lewis Index (TLI)                       0.934
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)               -736.817
##   Loglikelihood unrestricted model (H1)       -721.939
##                                                       
##   Akaike (AIC)                                1509.634
##   Bayesian (BIC)                              1561.525
##   Sample-size adjusted Bayesian (SABIC)       1504.591
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.070
##   90 Percent confidence interval - lower         0.015
##   90 Percent confidence interval - upper         0.114
##   P-value H_0: RMSEA &lt;= 0.050                    0.211
##   P-value H_0: RMSEA &gt;= 0.080                    0.393
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.062
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
##   AdolD =~                                                              
##     CD_1              1.000                               1.000    1.000
##     CD_2              1.111    0.140    7.955    0.000    0.837    1.385
##     CD_3              0.598    0.082    7.274    0.000    0.437    0.759
##   EffectP =~                                                            
##     PAPmoni           1.000                               1.000    1.000
##     PAPWARM           0.795    0.167    4.751    0.000    0.467    1.123
##     PAPsolic          1.147    0.231    4.972    0.000    0.695    1.600
##     PAPrule           0.620    0.155    3.990    0.000    0.315    0.924
##    Std.lv  Std.all
##                   
##     0.541    0.713
##     0.601    0.960
##     0.323    0.654
##                   
##     0.335    0.528
##     0.267    0.592
##     0.385    0.855
##     0.208    0.455
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
##   PSE ~                                                                 
##     EffectP           0.646    0.205    3.143    0.002    0.243    1.049
##   AdolD ~                                                               
##     EffectP          -0.298    0.172   -1.730    0.084   -0.636    0.040
##     PSE              -0.247    0.081   -3.064    0.002   -0.406   -0.089
##    Std.lv  Std.all
##                   
##     0.216    0.335
##                   
##    -0.185   -0.185
##    -0.457   -0.295
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
##    .CD_1              0.283    0.044    6.413    0.000    0.197    0.369
##    .CD_2              0.031    0.033    0.927    0.354   -0.034    0.096
##    .CD_3              0.139    0.020    7.053    0.000    0.101    0.178
##    .PAPmoni           0.291    0.041    7.173    0.000    0.211    0.370
##    .PAPWARM           0.132    0.020    6.691    0.000    0.093    0.170
##    .PAPsolic          0.054    0.022    2.468    0.014    0.011    0.098
##    .PAPrule           0.166    0.022    7.524    0.000    0.123    0.209
##    .PSE               0.370    0.047    7.850    0.000    0.278    0.463
##    .AdolD             0.246    0.056    4.385    0.000    0.136    0.356
##     EffectP           0.112    0.039    2.861    0.004    0.035    0.189
##    Std.lv  Std.all
##     0.283    0.492
##     0.031    0.078
##     0.139    0.572
##     0.291    0.721
##     0.132    0.650
##     0.054    0.269
##     0.166    0.793
##     0.370    0.888
##     0.842    0.842
##     1.000    1.000</code></pre>
<pre class="r"><code>modindices(fit1, sort.=TRUE)</code></pre>
<pre><code>##         lhs op      rhs     mi    epc sepc.lv sepc.all sepc.nox
## 45  PAPmoni ~~  PAPrule 17.031  0.091   0.091    0.414    0.414
## 46  PAPWARM ~~ PAPsolic  5.606  0.061   0.061    0.719    0.719
## 47  PAPWARM ~~  PAPrule  5.538 -0.037  -0.037   -0.251   -0.251
## 30     CD_1 ~~  PAPmoni  3.035  0.047   0.047    0.164    0.164
## 43  PAPmoni ~~  PAPWARM  2.681 -0.037  -0.037   -0.191   -0.191
## 31     CD_1 ~~  PAPWARM  2.081 -0.027  -0.027   -0.138   -0.138
## 44  PAPmoni ~~ PAPsolic  1.712 -0.041  -0.041   -0.326   -0.326
## 41     CD_3 ~~ PAPsolic  1.634  0.015   0.015    0.168    0.168
## 22    AdolD =~  PAPWARM  1.603 -0.090  -0.048   -0.108   -0.108
## 40     CD_3 ~~  PAPWARM  1.255 -0.014  -0.014   -0.106   -0.106
## 35     CD_2 ~~  PAPmoni  1.088 -0.020  -0.020   -0.212   -0.212
## 36     CD_2 ~~  PAPWARM  0.985  0.013   0.013    0.206    0.206
## 42     CD_3 ~~  PAPrule  0.784 -0.012  -0.012   -0.081   -0.081
## 34     CD_2 ~~     CD_3  0.676  0.037   0.037    0.561    0.561
## 24    AdolD =~  PAPrule  0.627  0.059   0.032    0.070    0.070
## 33     CD_1 ~~  PAPrule  0.603  0.016   0.016    0.072    0.072
## 32     CD_1 ~~ PAPsolic  0.586 -0.013  -0.013   -0.102   -0.102
## 29     CD_1 ~~     CD_3  0.518 -0.024  -0.024   -0.123   -0.123
## 25  EffectP =~     CD_1  0.409 -0.112  -0.038   -0.050   -0.050
## 48 PAPsolic ~~  PAPrule  0.355 -0.012  -0.012   -0.124   -0.124
## 26  EffectP =~     CD_2  0.280  0.083   0.028    0.045    0.045
## 23    AdolD =~ PAPsolic  0.279  0.042   0.023    0.050    0.050
## 39     CD_3 ~~  PAPmoni  0.137 -0.007  -0.007   -0.034   -0.034
## 38     CD_2 ~~  PAPrule  0.125  0.005   0.005    0.071    0.071
## 37     CD_2 ~~ PAPsolic  0.002  0.000   0.000    0.012    0.012
## 28     CD_1 ~~     CD_2  0.001  0.003   0.003    0.031    0.031
## 27  EffectP =~     CD_3  0.000 -0.002  -0.001   -0.002   -0.002
## 21    AdolD =~  PAPmoni  0.000  0.000   0.000    0.000    0.000</code></pre>
<pre class="r"><code>inspect(fit1, what=&quot;std&quot;)</code></pre>
<pre><code>## $lambda
##          AdolD EffctP PSE
## CD_1     0.713  0.000   0
## CD_2     0.960  0.000   0
## CD_3     0.654  0.000   0
## PAPmoni  0.000  0.528   0
## PAPWARM  0.000  0.592   0
## PAPsolic 0.000  0.855   0
## PAPrule  0.000  0.455   0
## PSE      0.000  0.000   1
## 
## $theta
##           CD_1  CD_2  CD_3 PAPmon PAPWAR PAPslc PAPrul   PSE
## CD_1     0.492                                              
## CD_2     0.000 0.078                                        
## CD_3     0.000 0.000 0.572                                  
## PAPmoni  0.000 0.000 0.000  0.721                           
## PAPWARM  0.000 0.000 0.000  0.000  0.650                    
## PAPsolic 0.000 0.000 0.000  0.000  0.000  0.269             
## PAPrule  0.000 0.000 0.000  0.000  0.000  0.000  0.793      
## PSE      0.000 0.000 0.000  0.000  0.000  0.000  0.000 0.000
## 
## $psi
##         AdolD EffctP   PSE
## AdolD   0.842             
## EffectP 0.000  1.000      
## PSE     0.000  0.000 0.888
## 
## $beta
##         AdolD EffctP    PSE
## AdolD       0 -0.185 -0.295
## EffectP     0  0.000  0.000
## PSE         0  0.335  0.000</code></pre>
<p>#Then I tested multiple models with different intervariable
correlations. #try to let all the effective parenting factors be able to
correlate with each other</p>
<pre class="r"><code>model2&lt;-&quot;AdolD=~CD_1 +CD_2 +CD_3
EffectP=~PAPmoni+PAPWARM+PAPsolic+PAPrule
PSE~EffectP
AdolD~EffectP + PSE&quot;
#residual correlations
PAPmoni~~PAPsoli</code></pre>
<pre><code>## PAPmoni ~ ~PAPsoli</code></pre>
<pre class="r"><code>PAPmoni~~PAPrule</code></pre>
<pre><code>## PAPmoni ~ ~PAPrule</code></pre>
<pre class="r"><code>PAPWARM~~PAPsoli</code></pre>
<pre><code>## PAPWARM ~ ~PAPsoli</code></pre>
<pre class="r"><code>PAPWARM~~PAPmoni</code></pre>
<pre><code>## PAPWARM ~ ~PAPmoni</code></pre>
<pre class="r"><code>PAPWARM~~PAPrule</code></pre>
<pre><code>## PAPWARM ~ ~PAPrule</code></pre>
<pre class="r"><code>PAPsoli~~PAPrule</code></pre>
<pre><code>## PAPsoli ~ ~PAPrule</code></pre>
<pre class="r"><code>CD_1~~CD_2</code></pre>
<pre><code>## CD_1 ~ ~CD_2</code></pre>
<pre class="r"><code>CD_1~~CD_3</code></pre>
<pre><code>## CD_1 ~ ~CD_3</code></pre>
<pre class="r"><code>CD_2~~CD_3</code></pre>
<pre><code>## CD_2 ~ ~CD_3</code></pre>
<pre class="r"><code>library(lavaan)
library(readxl)
library(dplyr)
library(haven)
teendata&lt;- Mother_and_teen_data %&gt;% filter( !is.na(PerPW)) 
fit2&lt;- sem(model2, data=Mother_and_teen_data)
fit2</code></pre>
<pre><code>## lavaan 0.6.14 ended normally after 36 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        18
## 
##                                                   Used       Total
##   Number of observations                           132         184
## 
## Model Test User Model:
##                                                       
##   Test statistic                                29.756
##   Degrees of freedom                                18
##   P-value (Chi-square)                           0.040</code></pre>
<pre class="r"><code>summary(fit2, standardized=TRUE, ci=TRUE, fit.measures=TRUE)</code></pre>
<pre><code>## lavaan 0.6.14 ended normally after 36 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        18
## 
##                                                   Used       Total
##   Number of observations                           132         184
## 
## Model Test User Model:
##                                                       
##   Test statistic                                29.756
##   Degrees of freedom                                18
##   P-value (Chi-square)                           0.040
## 
## Model Test Baseline Model:
## 
##   Test statistic                               306.486
##   Degrees of freedom                                28
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    0.958
##   Tucker-Lewis Index (TLI)                       0.934
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)               -736.817
##   Loglikelihood unrestricted model (H1)       -721.939
##                                                       
##   Akaike (AIC)                                1509.634
##   Bayesian (BIC)                              1561.525
##   Sample-size adjusted Bayesian (SABIC)       1504.591
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.070
##   90 Percent confidence interval - lower         0.015
##   90 Percent confidence interval - upper         0.114
##   P-value H_0: RMSEA &lt;= 0.050                    0.211
##   P-value H_0: RMSEA &gt;= 0.080                    0.393
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.062
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
##   AdolD =~                                                              
##     CD_1              1.000                               1.000    1.000
##     CD_2              1.111    0.140    7.955    0.000    0.837    1.385
##     CD_3              0.598    0.082    7.274    0.000    0.437    0.759
##   EffectP =~                                                            
##     PAPmoni           1.000                               1.000    1.000
##     PAPWARM           0.795    0.167    4.751    0.000    0.467    1.123
##     PAPsolic          1.147    0.231    4.972    0.000    0.695    1.600
##     PAPrule           0.620    0.155    3.990    0.000    0.315    0.924
##    Std.lv  Std.all
##                   
##     0.541    0.713
##     0.601    0.960
##     0.323    0.654
##                   
##     0.335    0.528
##     0.267    0.592
##     0.385    0.855
##     0.208    0.455
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
##   PSE ~                                                                 
##     EffectP           0.646    0.205    3.143    0.002    0.243    1.049
##   AdolD ~                                                               
##     EffectP          -0.298    0.172   -1.730    0.084   -0.636    0.040
##     PSE              -0.247    0.081   -3.064    0.002   -0.406   -0.089
##    Std.lv  Std.all
##                   
##     0.216    0.335
##                   
##    -0.185   -0.185
##    -0.457   -0.295
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
##    .CD_1              0.283    0.044    6.413    0.000    0.197    0.369
##    .CD_2              0.031    0.033    0.927    0.354   -0.034    0.096
##    .CD_3              0.139    0.020    7.053    0.000    0.101    0.178
##    .PAPmoni           0.291    0.041    7.173    0.000    0.211    0.370
##    .PAPWARM           0.132    0.020    6.691    0.000    0.093    0.170
##    .PAPsolic          0.054    0.022    2.468    0.014    0.011    0.098
##    .PAPrule           0.166    0.022    7.524    0.000    0.123    0.209
##    .PSE               0.370    0.047    7.850    0.000    0.278    0.463
##    .AdolD             0.246    0.056    4.385    0.000    0.136    0.356
##     EffectP           0.112    0.039    2.861    0.004    0.035    0.189
##    Std.lv  Std.all
##     0.283    0.492
##     0.031    0.078
##     0.139    0.572
##     0.291    0.721
##     0.132    0.650
##     0.054    0.269
##     0.166    0.793
##     0.370    0.888
##     0.842    0.842
##     1.000    1.000</code></pre>
<pre class="r"><code>modindices(fit2, sort.=TRUE)</code></pre>
<pre><code>##         lhs op      rhs     mi    epc sepc.lv sepc.all sepc.nox
## 45  PAPmoni ~~  PAPrule 17.031  0.091   0.091    0.414    0.414
## 46  PAPWARM ~~ PAPsolic  5.606  0.061   0.061    0.719    0.719
## 47  PAPWARM ~~  PAPrule  5.538 -0.037  -0.037   -0.251   -0.251
## 30     CD_1 ~~  PAPmoni  3.035  0.047   0.047    0.164    0.164
## 43  PAPmoni ~~  PAPWARM  2.681 -0.037  -0.037   -0.191   -0.191
## 31     CD_1 ~~  PAPWARM  2.081 -0.027  -0.027   -0.138   -0.138
## 44  PAPmoni ~~ PAPsolic  1.712 -0.041  -0.041   -0.326   -0.326
## 41     CD_3 ~~ PAPsolic  1.634  0.015   0.015    0.168    0.168
## 22    AdolD =~  PAPWARM  1.603 -0.090  -0.048   -0.108   -0.108
## 40     CD_3 ~~  PAPWARM  1.255 -0.014  -0.014   -0.106   -0.106
## 35     CD_2 ~~  PAPmoni  1.088 -0.020  -0.020   -0.212   -0.212
## 36     CD_2 ~~  PAPWARM  0.985  0.013   0.013    0.206    0.206
## 42     CD_3 ~~  PAPrule  0.784 -0.012  -0.012   -0.081   -0.081
## 34     CD_2 ~~     CD_3  0.676  0.037   0.037    0.561    0.561
## 24    AdolD =~  PAPrule  0.627  0.059   0.032    0.070    0.070
## 33     CD_1 ~~  PAPrule  0.603  0.016   0.016    0.072    0.072
## 32     CD_1 ~~ PAPsolic  0.586 -0.013  -0.013   -0.102   -0.102
## 29     CD_1 ~~     CD_3  0.518 -0.024  -0.024   -0.123   -0.123
## 25  EffectP =~     CD_1  0.409 -0.112  -0.038   -0.050   -0.050
## 48 PAPsolic ~~  PAPrule  0.355 -0.012  -0.012   -0.124   -0.124
## 26  EffectP =~     CD_2  0.280  0.083   0.028    0.045    0.045
## 23    AdolD =~ PAPsolic  0.279  0.042   0.023    0.050    0.050
## 39     CD_3 ~~  PAPmoni  0.137 -0.007  -0.007   -0.034   -0.034
## 38     CD_2 ~~  PAPrule  0.125  0.005   0.005    0.071    0.071
## 37     CD_2 ~~ PAPsolic  0.002  0.000   0.000    0.012    0.012
## 28     CD_1 ~~     CD_2  0.001  0.003   0.003    0.031    0.031
## 27  EffectP =~     CD_3  0.000 -0.002  -0.001   -0.002   -0.002
## 21    AdolD =~  PAPmoni  0.000  0.000   0.000    0.000    0.000</code></pre>
<pre class="r"><code>inspect(fit2, what=&quot;std&quot;)</code></pre>
<pre><code>## $lambda
##          AdolD EffctP PSE
## CD_1     0.713  0.000   0
## CD_2     0.960  0.000   0
## CD_3     0.654  0.000   0
## PAPmoni  0.000  0.528   0
## PAPWARM  0.000  0.592   0
## PAPsolic 0.000  0.855   0
## PAPrule  0.000  0.455   0
## PSE      0.000  0.000   1
## 
## $theta
##           CD_1  CD_2  CD_3 PAPmon PAPWAR PAPslc PAPrul   PSE
## CD_1     0.492                                              
## CD_2     0.000 0.078                                        
## CD_3     0.000 0.000 0.572                                  
## PAPmoni  0.000 0.000 0.000  0.721                           
## PAPWARM  0.000 0.000 0.000  0.000  0.650                    
## PAPsolic 0.000 0.000 0.000  0.000  0.000  0.269             
## PAPrule  0.000 0.000 0.000  0.000  0.000  0.000  0.793      
## PSE      0.000 0.000 0.000  0.000  0.000  0.000  0.000 0.000
## 
## $psi
##         AdolD EffctP   PSE
## AdolD   0.842             
## EffectP 0.000  1.000      
## PSE     0.000  0.000 0.888
## 
## $beta
##         AdolD EffctP    PSE
## AdolD       0 -0.185 -0.295
## EffectP     0  0.000  0.000
## PSE         0  0.335  0.000</code></pre>
<pre class="r"><code>fitmeasures(fit2)</code></pre>
<pre><code>##                  npar                  fmin                 chisq 
##                18.000                 0.113                29.756 
##                    df                pvalue        baseline.chisq 
##                18.000                 0.040               306.486 
##           baseline.df       baseline.pvalue                   cfi 
##                28.000                 0.000                 0.958 
##                   tli                  nnfi                   rfi 
##                 0.934                 0.934                 0.849 
##                   nfi                  pnfi                   ifi 
##                 0.903                 0.580                 0.959 
##                   rni                  logl     unrestricted.logl 
##                 0.958              -736.817              -721.939 
##                   aic                   bic                ntotal 
##              1509.634              1561.525               132.000 
##                  bic2                 rmsea        rmsea.ci.lower 
##              1504.591                 0.070                 0.015 
##        rmsea.ci.upper        rmsea.ci.level          rmsea.pvalue 
##                 0.114                 0.900                 0.211 
##        rmsea.close.h0 rmsea.notclose.pvalue     rmsea.notclose.h0 
##                 0.050                 0.393                 0.080 
##                   rmr            rmr_nomean                  srmr 
##                 0.019                 0.019                 0.062 
##          srmr_bentler   srmr_bentler_nomean                  crmr 
##                 0.062                 0.062                 0.070 
##           crmr_nomean            srmr_mplus     srmr_mplus_nomean 
##                 0.070                 0.062                 0.062 
##                 cn_05                 cn_01                   gfi 
##               129.067               155.400                 0.944 
##                  agfi                  pgfi                   mfi 
##                 0.888                 0.472                 0.956 
##                  ecvi 
##                 0.498</code></pre>
<pre class="r"><code>#does not make any noticeable change.</code></pre>
<pre class="r"><code>#try to let let monitoring correlates with the rules and solicitation correlates with monitoring
model3&lt;-&quot;AdolD=~CD_1 +CD_2 +CD_3
EffectP=~PAPmoni+PAPWARM+PAPsolic+PAPrule
PSE~EffectP
AdolD~EffectP + PSE&quot;
#residual correlations
PAPmoni~~PAPsoli</code></pre>
<pre><code>## PAPmoni ~ ~PAPsoli</code></pre>
<pre class="r"><code>PAPmoni~~PAPrule</code></pre>
<pre><code>## PAPmoni ~ ~PAPrule</code></pre>
<pre class="r"><code>CD_1~~CD_3</code></pre>
<pre><code>## CD_1 ~ ~CD_3</code></pre>
<pre class="r"><code>library(semPlot)
library(lavaan)
library(readxl)
library(dplyr)
library(haven)
teendata&lt;- Mother_and_teen_data %&gt;% filter( !is.na(PerPW)) 
fit3&lt;- sem(model3, data=Mother_and_teen_data)
fit3</code></pre>
<pre><code>## lavaan 0.6.14 ended normally after 36 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        18
## 
##                                                   Used       Total
##   Number of observations                           132         184
## 
## Model Test User Model:
##                                                       
##   Test statistic                                29.756
##   Degrees of freedom                                18
##   P-value (Chi-square)                           0.040</code></pre>
<pre class="r"><code>summary(fit3, standardized=TRUE, ci=TRUE, fit.measures=TRUE)</code></pre>
<pre><code>## lavaan 0.6.14 ended normally after 36 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        18
## 
##                                                   Used       Total
##   Number of observations                           132         184
## 
## Model Test User Model:
##                                                       
##   Test statistic                                29.756
##   Degrees of freedom                                18
##   P-value (Chi-square)                           0.040
## 
## Model Test Baseline Model:
## 
##   Test statistic                               306.486
##   Degrees of freedom                                28
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    0.958
##   Tucker-Lewis Index (TLI)                       0.934
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)               -736.817
##   Loglikelihood unrestricted model (H1)       -721.939
##                                                       
##   Akaike (AIC)                                1509.634
##   Bayesian (BIC)                              1561.525
##   Sample-size adjusted Bayesian (SABIC)       1504.591
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.070
##   90 Percent confidence interval - lower         0.015
##   90 Percent confidence interval - upper         0.114
##   P-value H_0: RMSEA &lt;= 0.050                    0.211
##   P-value H_0: RMSEA &gt;= 0.080                    0.393
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.062
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
##   AdolD =~                                                              
##     CD_1              1.000                               1.000    1.000
##     CD_2              1.111    0.140    7.955    0.000    0.837    1.385
##     CD_3              0.598    0.082    7.274    0.000    0.437    0.759
##   EffectP =~                                                            
##     PAPmoni           1.000                               1.000    1.000
##     PAPWARM           0.795    0.167    4.751    0.000    0.467    1.123
##     PAPsolic          1.147    0.231    4.972    0.000    0.695    1.600
##     PAPrule           0.620    0.155    3.990    0.000    0.315    0.924
##    Std.lv  Std.all
##                   
##     0.541    0.713
##     0.601    0.960
##     0.323    0.654
##                   
##     0.335    0.528
##     0.267    0.592
##     0.385    0.855
##     0.208    0.455
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
##   PSE ~                                                                 
##     EffectP           0.646    0.205    3.143    0.002    0.243    1.049
##   AdolD ~                                                               
##     EffectP          -0.298    0.172   -1.730    0.084   -0.636    0.040
##     PSE              -0.247    0.081   -3.064    0.002   -0.406   -0.089
##    Std.lv  Std.all
##                   
##     0.216    0.335
##                   
##    -0.185   -0.185
##    -0.457   -0.295
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
##    .CD_1              0.283    0.044    6.413    0.000    0.197    0.369
##    .CD_2              0.031    0.033    0.927    0.354   -0.034    0.096
##    .CD_3              0.139    0.020    7.053    0.000    0.101    0.178
##    .PAPmoni           0.291    0.041    7.173    0.000    0.211    0.370
##    .PAPWARM           0.132    0.020    6.691    0.000    0.093    0.170
##    .PAPsolic          0.054    0.022    2.468    0.014    0.011    0.098
##    .PAPrule           0.166    0.022    7.524    0.000    0.123    0.209
##    .PSE               0.370    0.047    7.850    0.000    0.278    0.463
##    .AdolD             0.246    0.056    4.385    0.000    0.136    0.356
##     EffectP           0.112    0.039    2.861    0.004    0.035    0.189
##    Std.lv  Std.all
##     0.283    0.492
##     0.031    0.078
##     0.139    0.572
##     0.291    0.721
##     0.132    0.650
##     0.054    0.269
##     0.166    0.793
##     0.370    0.888
##     0.842    0.842
##     1.000    1.000</code></pre>
<pre class="r"><code>modindices(fit3, sort.=TRUE)</code></pre>
<pre><code>##         lhs op      rhs     mi    epc sepc.lv sepc.all sepc.nox
## 45  PAPmoni ~~  PAPrule 17.031  0.091   0.091    0.414    0.414
## 46  PAPWARM ~~ PAPsolic  5.606  0.061   0.061    0.719    0.719
## 47  PAPWARM ~~  PAPrule  5.538 -0.037  -0.037   -0.251   -0.251
## 30     CD_1 ~~  PAPmoni  3.035  0.047   0.047    0.164    0.164
## 43  PAPmoni ~~  PAPWARM  2.681 -0.037  -0.037   -0.191   -0.191
## 31     CD_1 ~~  PAPWARM  2.081 -0.027  -0.027   -0.138   -0.138
## 44  PAPmoni ~~ PAPsolic  1.712 -0.041  -0.041   -0.326   -0.326
## 41     CD_3 ~~ PAPsolic  1.634  0.015   0.015    0.168    0.168
## 22    AdolD =~  PAPWARM  1.603 -0.090  -0.048   -0.108   -0.108
## 40     CD_3 ~~  PAPWARM  1.255 -0.014  -0.014   -0.106   -0.106
## 35     CD_2 ~~  PAPmoni  1.088 -0.020  -0.020   -0.212   -0.212
## 36     CD_2 ~~  PAPWARM  0.985  0.013   0.013    0.206    0.206
## 42     CD_3 ~~  PAPrule  0.784 -0.012  -0.012   -0.081   -0.081
## 34     CD_2 ~~     CD_3  0.676  0.037   0.037    0.561    0.561
## 24    AdolD =~  PAPrule  0.627  0.059   0.032    0.070    0.070
## 33     CD_1 ~~  PAPrule  0.603  0.016   0.016    0.072    0.072
## 32     CD_1 ~~ PAPsolic  0.586 -0.013  -0.013   -0.102   -0.102
## 29     CD_1 ~~     CD_3  0.518 -0.024  -0.024   -0.123   -0.123
## 25  EffectP =~     CD_1  0.409 -0.112  -0.038   -0.050   -0.050
## 48 PAPsolic ~~  PAPrule  0.355 -0.012  -0.012   -0.124   -0.124
## 26  EffectP =~     CD_2  0.280  0.083   0.028    0.045    0.045
## 23    AdolD =~ PAPsolic  0.279  0.042   0.023    0.050    0.050
## 39     CD_3 ~~  PAPmoni  0.137 -0.007  -0.007   -0.034   -0.034
## 38     CD_2 ~~  PAPrule  0.125  0.005   0.005    0.071    0.071
## 37     CD_2 ~~ PAPsolic  0.002  0.000   0.000    0.012    0.012
## 28     CD_1 ~~     CD_2  0.001  0.003   0.003    0.031    0.031
## 27  EffectP =~     CD_3  0.000 -0.002  -0.001   -0.002   -0.002
## 21    AdolD =~  PAPmoni  0.000  0.000   0.000    0.000    0.000</code></pre>
<pre class="r"><code>inspect(fit3, what=&quot;std&quot;)</code></pre>
<pre><code>## $lambda
##          AdolD EffctP PSE
## CD_1     0.713  0.000   0
## CD_2     0.960  0.000   0
## CD_3     0.654  0.000   0
## PAPmoni  0.000  0.528   0
## PAPWARM  0.000  0.592   0
## PAPsolic 0.000  0.855   0
## PAPrule  0.000  0.455   0
## PSE      0.000  0.000   1
## 
## $theta
##           CD_1  CD_2  CD_3 PAPmon PAPWAR PAPslc PAPrul   PSE
## CD_1     0.492                                              
## CD_2     0.000 0.078                                        
## CD_3     0.000 0.000 0.572                                  
## PAPmoni  0.000 0.000 0.000  0.721                           
## PAPWARM  0.000 0.000 0.000  0.000  0.650                    
## PAPsolic 0.000 0.000 0.000  0.000  0.000  0.269             
## PAPrule  0.000 0.000 0.000  0.000  0.000  0.000  0.793      
## PSE      0.000 0.000 0.000  0.000  0.000  0.000  0.000 0.000
## 
## $psi
##         AdolD EffctP   PSE
## AdolD   0.842             
## EffectP 0.000  1.000      
## PSE     0.000  0.000 0.888
## 
## $beta
##         AdolD EffctP    PSE
## AdolD       0 -0.185 -0.295
## EffectP     0  0.000  0.000
## PSE         0  0.335  0.000</code></pre>
<pre class="r"><code>parameterestimates(fit3, standardized = TRUE)</code></pre>
<pre><code>##         lhs op      rhs    est    se      z pvalue ci.lower ci.upper std.lv
## 1     AdolD =~     CD_1  1.000 0.000     NA     NA    1.000    1.000  0.541
## 2     AdolD =~     CD_2  1.111 0.140  7.955  0.000    0.837    1.385  0.601
## 3     AdolD =~     CD_3  0.598 0.082  7.274  0.000    0.437    0.759  0.323
## 4   EffectP =~  PAPmoni  1.000 0.000     NA     NA    1.000    1.000  0.335
## 5   EffectP =~  PAPWARM  0.795 0.167  4.751  0.000    0.467    1.123  0.267
## 6   EffectP =~ PAPsolic  1.147 0.231  4.972  0.000    0.695    1.600  0.385
## 7   EffectP =~  PAPrule  0.620 0.155  3.990  0.000    0.315    0.924  0.208
## 8       PSE  ~  EffectP  0.646 0.205  3.143  0.002    0.243    1.049  0.216
## 9     AdolD  ~  EffectP -0.298 0.172 -1.730  0.084   -0.636    0.040 -0.185
## 10    AdolD  ~      PSE -0.247 0.081 -3.064  0.002   -0.406   -0.089 -0.457
## 11     CD_1 ~~     CD_1  0.283 0.044  6.413  0.000    0.197    0.369  0.283
## 12     CD_2 ~~     CD_2  0.031 0.033  0.927  0.354   -0.034    0.096  0.031
## 13     CD_3 ~~     CD_3  0.139 0.020  7.053  0.000    0.101    0.178  0.139
## 14  PAPmoni ~~  PAPmoni  0.291 0.041  7.173  0.000    0.211    0.370  0.291
## 15  PAPWARM ~~  PAPWARM  0.132 0.020  6.691  0.000    0.093    0.170  0.132
## 16 PAPsolic ~~ PAPsolic  0.054 0.022  2.468  0.014    0.011    0.098  0.054
## 17  PAPrule ~~  PAPrule  0.166 0.022  7.524  0.000    0.123    0.209  0.166
## 18      PSE ~~      PSE  0.370 0.047  7.850  0.000    0.278    0.463  0.370
## 19    AdolD ~~    AdolD  0.246 0.056  4.385  0.000    0.136    0.356  0.842
## 20  EffectP ~~  EffectP  0.112 0.039  2.861  0.004    0.035    0.189  1.000
##    std.all std.nox
## 1    0.713   0.713
## 2    0.960   0.960
## 3    0.654   0.654
## 4    0.528   0.528
## 5    0.592   0.592
## 6    0.855   0.855
## 7    0.455   0.455
## 8    0.335   0.335
## 9   -0.185  -0.185
## 10  -0.295  -0.295
## 11   0.492   0.492
## 12   0.078   0.078
## 13   0.572   0.572
## 14   0.721   0.721
## 15   0.650   0.650
## 16   0.269   0.269
## 17   0.793   0.793
## 18   0.888   0.888
## 19   0.842   0.842
## 20   1.000   1.000</code></pre>
<pre class="r"><code>fitted(fit3)</code></pre>
<pre><code>## $cov
##            CD_1   CD_2   CD_3 PAPmon PAPWAR PAPslc PAPrul    PSE
## CD_1      0.575                                                 
## CD_2      0.325  0.392                                          
## CD_3      0.175  0.194  0.244                                   
## PAPmoni  -0.051 -0.057 -0.031  0.403                            
## PAPWARM  -0.041 -0.045 -0.024  0.089  0.203                     
## PAPsolic -0.059 -0.066 -0.035  0.129  0.103  0.202              
## PAPrule  -0.032 -0.035 -0.019  0.070  0.055  0.080  0.209       
## PSE      -0.125 -0.139 -0.075  0.073  0.058  0.083  0.045  0.417</code></pre>
<pre class="r"><code>residuals(fit3)</code></pre>
<pre><code>## $type
## [1] &quot;raw&quot;
## 
## $cov
##            CD_1   CD_2   CD_3 PAPmon PAPWAR PAPslc PAPrul    PSE
## CD_1      0.000                                                 
## CD_2      0.000  0.000                                          
## CD_3     -0.006  0.001  0.000                                   
## PAPmoni   0.033 -0.003 -0.006  0.000                            
## PAPWARM  -0.046 -0.017 -0.023 -0.021  0.000                     
## PAPsolic -0.012  0.004  0.008 -0.005  0.005  0.000              
## PAPrule   0.022  0.016 -0.003  0.068 -0.025 -0.002  0.000       
## PSE      -0.017  0.002 -0.001 -0.017  0.026 -0.001 -0.018  0.000</code></pre>
<pre class="r"><code>fitmeasures(fit3)</code></pre>
<pre><code>##                  npar                  fmin                 chisq 
##                18.000                 0.113                29.756 
##                    df                pvalue        baseline.chisq 
##                18.000                 0.040               306.486 
##           baseline.df       baseline.pvalue                   cfi 
##                28.000                 0.000                 0.958 
##                   tli                  nnfi                   rfi 
##                 0.934                 0.934                 0.849 
##                   nfi                  pnfi                   ifi 
##                 0.903                 0.580                 0.959 
##                   rni                  logl     unrestricted.logl 
##                 0.958              -736.817              -721.939 
##                   aic                   bic                ntotal 
##              1509.634              1561.525               132.000 
##                  bic2                 rmsea        rmsea.ci.lower 
##              1504.591                 0.070                 0.015 
##        rmsea.ci.upper        rmsea.ci.level          rmsea.pvalue 
##                 0.114                 0.900                 0.211 
##        rmsea.close.h0 rmsea.notclose.pvalue     rmsea.notclose.h0 
##                 0.050                 0.393                 0.080 
##                   rmr            rmr_nomean                  srmr 
##                 0.019                 0.019                 0.062 
##          srmr_bentler   srmr_bentler_nomean                  crmr 
##                 0.062                 0.062                 0.070 
##           crmr_nomean            srmr_mplus     srmr_mplus_nomean 
##                 0.070                 0.062                 0.062 
##                 cn_05                 cn_01                   gfi 
##               129.067               155.400                 0.944 
##                  agfi                  pgfi                   mfi 
##                 0.888                 0.472                 0.956 
##                  ecvi 
##                 0.498</code></pre>
<pre class="r"><code>modificationindices(fit3, sort. = TRUE)</code></pre>
<pre><code>##         lhs op      rhs     mi    epc sepc.lv sepc.all sepc.nox
## 45  PAPmoni ~~  PAPrule 17.031  0.091   0.091    0.414    0.414
## 46  PAPWARM ~~ PAPsolic  5.606  0.061   0.061    0.719    0.719
## 47  PAPWARM ~~  PAPrule  5.538 -0.037  -0.037   -0.251   -0.251
## 30     CD_1 ~~  PAPmoni  3.035  0.047   0.047    0.164    0.164
## 43  PAPmoni ~~  PAPWARM  2.681 -0.037  -0.037   -0.191   -0.191
## 31     CD_1 ~~  PAPWARM  2.081 -0.027  -0.027   -0.138   -0.138
## 44  PAPmoni ~~ PAPsolic  1.712 -0.041  -0.041   -0.326   -0.326
## 41     CD_3 ~~ PAPsolic  1.634  0.015   0.015    0.168    0.168
## 22    AdolD =~  PAPWARM  1.603 -0.090  -0.048   -0.108   -0.108
## 40     CD_3 ~~  PAPWARM  1.255 -0.014  -0.014   -0.106   -0.106
## 35     CD_2 ~~  PAPmoni  1.088 -0.020  -0.020   -0.212   -0.212
## 36     CD_2 ~~  PAPWARM  0.985  0.013   0.013    0.206    0.206
## 42     CD_3 ~~  PAPrule  0.784 -0.012  -0.012   -0.081   -0.081
## 34     CD_2 ~~     CD_3  0.676  0.037   0.037    0.561    0.561
## 24    AdolD =~  PAPrule  0.627  0.059   0.032    0.070    0.070
## 33     CD_1 ~~  PAPrule  0.603  0.016   0.016    0.072    0.072
## 32     CD_1 ~~ PAPsolic  0.586 -0.013  -0.013   -0.102   -0.102
## 29     CD_1 ~~     CD_3  0.518 -0.024  -0.024   -0.123   -0.123
## 25  EffectP =~     CD_1  0.409 -0.112  -0.038   -0.050   -0.050
## 48 PAPsolic ~~  PAPrule  0.355 -0.012  -0.012   -0.124   -0.124
## 26  EffectP =~     CD_2  0.280  0.083   0.028    0.045    0.045
## 23    AdolD =~ PAPsolic  0.279  0.042   0.023    0.050    0.050
## 39     CD_3 ~~  PAPmoni  0.137 -0.007  -0.007   -0.034   -0.034
## 38     CD_2 ~~  PAPrule  0.125  0.005   0.005    0.071    0.071
## 37     CD_2 ~~ PAPsolic  0.002  0.000   0.000    0.012    0.012
## 28     CD_1 ~~     CD_2  0.001  0.003   0.003    0.031    0.031
## 27  EffectP =~     CD_3  0.000 -0.002  -0.001   -0.002   -0.002
## 21    AdolD =~  PAPmoni  0.000  0.000   0.000    0.000    0.000</code></pre>
<pre class="r"><code>semPaths(fit3, what=&quot;paths&quot;, whatLables=&quot;par&quot;, rotation=2)</code></pre>
<pre><code>## Warning in qgraph::qgraph(Edgelist, labels = nLab, bidirectional = Bidir, : The
## following arguments are not documented and likely not arguments of qgraph and
## thus ignored: whatLables</code></pre>
<p><img src="p10_files/figure-html/test%20model%203-1.png" width="672" /></p>
<pre class="r"><code>fitmeasures(fit3)</code></pre>
<pre><code>##                  npar                  fmin                 chisq 
##                18.000                 0.113                29.756 
##                    df                pvalue        baseline.chisq 
##                18.000                 0.040               306.486 
##           baseline.df       baseline.pvalue                   cfi 
##                28.000                 0.000                 0.958 
##                   tli                  nnfi                   rfi 
##                 0.934                 0.934                 0.849 
##                   nfi                  pnfi                   ifi 
##                 0.903                 0.580                 0.959 
##                   rni                  logl     unrestricted.logl 
##                 0.958              -736.817              -721.939 
##                   aic                   bic                ntotal 
##              1509.634              1561.525               132.000 
##                  bic2                 rmsea        rmsea.ci.lower 
##              1504.591                 0.070                 0.015 
##        rmsea.ci.upper        rmsea.ci.level          rmsea.pvalue 
##                 0.114                 0.900                 0.211 
##        rmsea.close.h0 rmsea.notclose.pvalue     rmsea.notclose.h0 
##                 0.050                 0.393                 0.080 
##                   rmr            rmr_nomean                  srmr 
##                 0.019                 0.019                 0.062 
##          srmr_bentler   srmr_bentler_nomean                  crmr 
##                 0.062                 0.062                 0.070 
##           crmr_nomean            srmr_mplus     srmr_mplus_nomean 
##                 0.070                 0.062                 0.062 
##                 cn_05                 cn_01                   gfi 
##               129.067               155.400                 0.944 
##                  agfi                  pgfi                   mfi 
##                 0.888                 0.472                 0.956 
##                  ecvi 
##                 0.498</code></pre>
<pre class="r"><code>#does not make any noticeable change as well.
#did not find significant better model. all three model seems alike. The fit measure difference is unnoticeable.</code></pre>
<pre class="r"><code>library(ggpubr)

compare_means(PSE ~ Race3,  data = mt)</code></pre>
<pre><code>## # A tibble: 3 × 8
##   .y.   group1 group2          p    p.adj p.format p.signif method  
##   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;   
## 1 PSE   1      2      0.00000460 0.000014 4.6e-06  ****     Wilcoxon
## 2 PSE   1      3      0.0884     0.088    0.088    ns       Wilcoxon
## 3 PSE   2      3      0.0125     0.025    0.013    *        Wilcoxon</code></pre>
<pre class="r"><code>my_comparisons &lt;- list( c(&quot;1&quot;, &quot;2&quot;), c(&quot;1&quot;, &quot;3&quot;), c(&quot;2&quot;, &quot;3&quot;) )
ggboxplot(mt, x = &quot;Race3&quot;, y = &quot;PSE&quot;,
          color = &quot;Race3&quot;, palette = &quot;jco&quot;)+ 
  labs(title= &quot;Cultural Difference in PSE&quot;, x=&quot;Race/Ethnicity&quot;, y=&quot;PSE&quot;, color=&quot;Race/Ethnicity&quot;) + 
  scale_x_discrete(labels=c(&#39;White&#39;, &#39;Latina&#39;, &#39;African American&#39;))+
  stat_compare_means(comparisons = my_comparisons)+ 
  stat_compare_means(label.y = 7)    </code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (`stat_boxplot()`).</code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (`stat_signif()`).</code></pre>
<pre><code>## Warning: Removed 1 rows containing non-finite values (`stat_compare_means()`).</code></pre>
<p><img src="p10_files/figure-html/comparison-1.png" width="672" /></p>
<pre class="r"><code>#VERY SATISFIED WITH THIS PLOT!</code></pre>
<pre class="r"><code>test_model1&lt;-&quot;AdolD=~CD_1 +CD_2 +CD_3
EffectP=~PAPmoni+PAPWARM+PAPsolic+PAPrule
PSE~EffectP
AdolD~EffectP + PSE&quot;
#residual correlations
PAPmoni~~PAPsoli</code></pre>
<pre><code>## PAPmoni ~ ~PAPsoli</code></pre>
<pre class="r"><code>PAPmoni~~PAPrule</code></pre>
<pre><code>## PAPmoni ~ ~PAPrule</code></pre>
<pre class="r"><code>PAPWARM~~PAPsoli</code></pre>
<pre><code>## PAPWARM ~ ~PAPsoli</code></pre>
<pre class="r"><code>CD_1~~CD_2</code></pre>
<pre><code>## CD_1 ~ ~CD_2</code></pre>
<pre class="r"><code>CD_1~~CD_3</code></pre>
<pre><code>## CD_1 ~ ~CD_3</code></pre>
<pre class="r"><code>CD_2~~CD_3</code></pre>
<pre><code>## CD_2 ~ ~CD_3</code></pre>
<pre class="r"><code>library(semPlot)
library(lavaan)
library(readxl)
library(dplyr)
library(haven)
teendata&lt;- Mother_and_teen_data %&gt;% filter( !is.na(PerPW)) 
fit1&lt;- sem(model1, data=Mother_and_teen_data)
fit1</code></pre>
<pre><code>## lavaan 0.6.14 ended normally after 36 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        18
## 
##                                                   Used       Total
##   Number of observations                           132         184
## 
## Model Test User Model:
##                                                       
##   Test statistic                                29.756
##   Degrees of freedom                                18
##   P-value (Chi-square)                           0.040</code></pre>
<pre class="r"><code>summary(fit1, standardized=TRUE, ci=TRUE, fit.measures=TRUE)</code></pre>
<pre><code>## lavaan 0.6.14 ended normally after 36 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        18
## 
##                                                   Used       Total
##   Number of observations                           132         184
## 
## Model Test User Model:
##                                                       
##   Test statistic                                29.756
##   Degrees of freedom                                18
##   P-value (Chi-square)                           0.040
## 
## Model Test Baseline Model:
## 
##   Test statistic                               306.486
##   Degrees of freedom                                28
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    0.958
##   Tucker-Lewis Index (TLI)                       0.934
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)               -736.817
##   Loglikelihood unrestricted model (H1)       -721.939
##                                                       
##   Akaike (AIC)                                1509.634
##   Bayesian (BIC)                              1561.525
##   Sample-size adjusted Bayesian (SABIC)       1504.591
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.070
##   90 Percent confidence interval - lower         0.015
##   90 Percent confidence interval - upper         0.114
##   P-value H_0: RMSEA &lt;= 0.050                    0.211
##   P-value H_0: RMSEA &gt;= 0.080                    0.393
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.062
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
##   AdolD =~                                                              
##     CD_1              1.000                               1.000    1.000
##     CD_2              1.111    0.140    7.955    0.000    0.837    1.385
##     CD_3              0.598    0.082    7.274    0.000    0.437    0.759
##   EffectP =~                                                            
##     PAPmoni           1.000                               1.000    1.000
##     PAPWARM           0.795    0.167    4.751    0.000    0.467    1.123
##     PAPsolic          1.147    0.231    4.972    0.000    0.695    1.600
##     PAPrule           0.620    0.155    3.990    0.000    0.315    0.924
##    Std.lv  Std.all
##                   
##     0.541    0.713
##     0.601    0.960
##     0.323    0.654
##                   
##     0.335    0.528
##     0.267    0.592
##     0.385    0.855
##     0.208    0.455
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
##   PSE ~                                                                 
##     EffectP           0.646    0.205    3.143    0.002    0.243    1.049
##   AdolD ~                                                               
##     EffectP          -0.298    0.172   -1.730    0.084   -0.636    0.040
##     PSE              -0.247    0.081   -3.064    0.002   -0.406   -0.089
##    Std.lv  Std.all
##                   
##     0.216    0.335
##                   
##    -0.185   -0.185
##    -0.457   -0.295
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
##    .CD_1              0.283    0.044    6.413    0.000    0.197    0.369
##    .CD_2              0.031    0.033    0.927    0.354   -0.034    0.096
##    .CD_3              0.139    0.020    7.053    0.000    0.101    0.178
##    .PAPmoni           0.291    0.041    7.173    0.000    0.211    0.370
##    .PAPWARM           0.132    0.020    6.691    0.000    0.093    0.170
##    .PAPsolic          0.054    0.022    2.468    0.014    0.011    0.098
##    .PAPrule           0.166    0.022    7.524    0.000    0.123    0.209
##    .PSE               0.370    0.047    7.850    0.000    0.278    0.463
##    .AdolD             0.246    0.056    4.385    0.000    0.136    0.356
##     EffectP           0.112    0.039    2.861    0.004    0.035    0.189
##    Std.lv  Std.all
##     0.283    0.492
##     0.031    0.078
##     0.139    0.572
##     0.291    0.721
##     0.132    0.650
##     0.054    0.269
##     0.166    0.793
##     0.370    0.888
##     0.842    0.842
##     1.000    1.000</code></pre>
<pre class="r"><code>modindices(fit1, sort.=TRUE)</code></pre>
<pre><code>##         lhs op      rhs     mi    epc sepc.lv sepc.all sepc.nox
## 45  PAPmoni ~~  PAPrule 17.031  0.091   0.091    0.414    0.414
## 46  PAPWARM ~~ PAPsolic  5.606  0.061   0.061    0.719    0.719
## 47  PAPWARM ~~  PAPrule  5.538 -0.037  -0.037   -0.251   -0.251
## 30     CD_1 ~~  PAPmoni  3.035  0.047   0.047    0.164    0.164
## 43  PAPmoni ~~  PAPWARM  2.681 -0.037  -0.037   -0.191   -0.191
## 31     CD_1 ~~  PAPWARM  2.081 -0.027  -0.027   -0.138   -0.138
## 44  PAPmoni ~~ PAPsolic  1.712 -0.041  -0.041   -0.326   -0.326
## 41     CD_3 ~~ PAPsolic  1.634  0.015   0.015    0.168    0.168
## 22    AdolD =~  PAPWARM  1.603 -0.090  -0.048   -0.108   -0.108
## 40     CD_3 ~~  PAPWARM  1.255 -0.014  -0.014   -0.106   -0.106
## 35     CD_2 ~~  PAPmoni  1.088 -0.020  -0.020   -0.212   -0.212
## 36     CD_2 ~~  PAPWARM  0.985  0.013   0.013    0.206    0.206
## 42     CD_3 ~~  PAPrule  0.784 -0.012  -0.012   -0.081   -0.081
## 34     CD_2 ~~     CD_3  0.676  0.037   0.037    0.561    0.561
## 24    AdolD =~  PAPrule  0.627  0.059   0.032    0.070    0.070
## 33     CD_1 ~~  PAPrule  0.603  0.016   0.016    0.072    0.072
## 32     CD_1 ~~ PAPsolic  0.586 -0.013  -0.013   -0.102   -0.102
## 29     CD_1 ~~     CD_3  0.518 -0.024  -0.024   -0.123   -0.123
## 25  EffectP =~     CD_1  0.409 -0.112  -0.038   -0.050   -0.050
## 48 PAPsolic ~~  PAPrule  0.355 -0.012  -0.012   -0.124   -0.124
## 26  EffectP =~     CD_2  0.280  0.083   0.028    0.045    0.045
## 23    AdolD =~ PAPsolic  0.279  0.042   0.023    0.050    0.050
## 39     CD_3 ~~  PAPmoni  0.137 -0.007  -0.007   -0.034   -0.034
## 38     CD_2 ~~  PAPrule  0.125  0.005   0.005    0.071    0.071
## 37     CD_2 ~~ PAPsolic  0.002  0.000   0.000    0.012    0.012
## 28     CD_1 ~~     CD_2  0.001  0.003   0.003    0.031    0.031
## 27  EffectP =~     CD_3  0.000 -0.002  -0.001   -0.002   -0.002
## 21    AdolD =~  PAPmoni  0.000  0.000   0.000    0.000    0.000</code></pre>
<pre class="r"><code>inspect(fit1, what=&quot;std&quot;)</code></pre>
<pre><code>## $lambda
##          AdolD EffctP PSE
## CD_1     0.713  0.000   0
## CD_2     0.960  0.000   0
## CD_3     0.654  0.000   0
## PAPmoni  0.000  0.528   0
## PAPWARM  0.000  0.592   0
## PAPsolic 0.000  0.855   0
## PAPrule  0.000  0.455   0
## PSE      0.000  0.000   1
## 
## $theta
##           CD_1  CD_2  CD_3 PAPmon PAPWAR PAPslc PAPrul   PSE
## CD_1     0.492                                              
## CD_2     0.000 0.078                                        
## CD_3     0.000 0.000 0.572                                  
## PAPmoni  0.000 0.000 0.000  0.721                           
## PAPWARM  0.000 0.000 0.000  0.000  0.650                    
## PAPsolic 0.000 0.000 0.000  0.000  0.000  0.269             
## PAPrule  0.000 0.000 0.000  0.000  0.000  0.000  0.793      
## PSE      0.000 0.000 0.000  0.000  0.000  0.000  0.000 0.000
## 
## $psi
##         AdolD EffctP   PSE
## AdolD   0.842             
## EffectP 0.000  1.000      
## PSE     0.000  0.000 0.888
## 
## $beta
##         AdolD EffctP    PSE
## AdolD       0 -0.185 -0.295
## EffectP     0  0.000  0.000
## PSE         0  0.335  0.000</code></pre>
<pre class="r"><code>parameterestimates(fit1, standardized = TRUE)</code></pre>
<pre><code>##         lhs op      rhs    est    se      z pvalue ci.lower ci.upper std.lv
## 1     AdolD =~     CD_1  1.000 0.000     NA     NA    1.000    1.000  0.541
## 2     AdolD =~     CD_2  1.111 0.140  7.955  0.000    0.837    1.385  0.601
## 3     AdolD =~     CD_3  0.598 0.082  7.274  0.000    0.437    0.759  0.323
## 4   EffectP =~  PAPmoni  1.000 0.000     NA     NA    1.000    1.000  0.335
## 5   EffectP =~  PAPWARM  0.795 0.167  4.751  0.000    0.467    1.123  0.267
## 6   EffectP =~ PAPsolic  1.147 0.231  4.972  0.000    0.695    1.600  0.385
## 7   EffectP =~  PAPrule  0.620 0.155  3.990  0.000    0.315    0.924  0.208
## 8       PSE  ~  EffectP  0.646 0.205  3.143  0.002    0.243    1.049  0.216
## 9     AdolD  ~  EffectP -0.298 0.172 -1.730  0.084   -0.636    0.040 -0.185
## 10    AdolD  ~      PSE -0.247 0.081 -3.064  0.002   -0.406   -0.089 -0.457
## 11     CD_1 ~~     CD_1  0.283 0.044  6.413  0.000    0.197    0.369  0.283
## 12     CD_2 ~~     CD_2  0.031 0.033  0.927  0.354   -0.034    0.096  0.031
## 13     CD_3 ~~     CD_3  0.139 0.020  7.053  0.000    0.101    0.178  0.139
## 14  PAPmoni ~~  PAPmoni  0.291 0.041  7.173  0.000    0.211    0.370  0.291
## 15  PAPWARM ~~  PAPWARM  0.132 0.020  6.691  0.000    0.093    0.170  0.132
## 16 PAPsolic ~~ PAPsolic  0.054 0.022  2.468  0.014    0.011    0.098  0.054
## 17  PAPrule ~~  PAPrule  0.166 0.022  7.524  0.000    0.123    0.209  0.166
## 18      PSE ~~      PSE  0.370 0.047  7.850  0.000    0.278    0.463  0.370
## 19    AdolD ~~    AdolD  0.246 0.056  4.385  0.000    0.136    0.356  0.842
## 20  EffectP ~~  EffectP  0.112 0.039  2.861  0.004    0.035    0.189  1.000
##    std.all std.nox
## 1    0.713   0.713
## 2    0.960   0.960
## 3    0.654   0.654
## 4    0.528   0.528
## 5    0.592   0.592
## 6    0.855   0.855
## 7    0.455   0.455
## 8    0.335   0.335
## 9   -0.185  -0.185
## 10  -0.295  -0.295
## 11   0.492   0.492
## 12   0.078   0.078
## 13   0.572   0.572
## 14   0.721   0.721
## 15   0.650   0.650
## 16   0.269   0.269
## 17   0.793   0.793
## 18   0.888   0.888
## 19   0.842   0.842
## 20   1.000   1.000</code></pre>
<pre class="r"><code>fitted(fit1)</code></pre>
<pre><code>## $cov
##            CD_1   CD_2   CD_3 PAPmon PAPWAR PAPslc PAPrul    PSE
## CD_1      0.575                                                 
## CD_2      0.325  0.392                                          
## CD_3      0.175  0.194  0.244                                   
## PAPmoni  -0.051 -0.057 -0.031  0.403                            
## PAPWARM  -0.041 -0.045 -0.024  0.089  0.203                     
## PAPsolic -0.059 -0.066 -0.035  0.129  0.103  0.202              
## PAPrule  -0.032 -0.035 -0.019  0.070  0.055  0.080  0.209       
## PSE      -0.125 -0.139 -0.075  0.073  0.058  0.083  0.045  0.417</code></pre>
<pre class="r"><code>residuals(fit1)</code></pre>
<pre><code>## $type
## [1] &quot;raw&quot;
## 
## $cov
##            CD_1   CD_2   CD_3 PAPmon PAPWAR PAPslc PAPrul    PSE
## CD_1      0.000                                                 
## CD_2      0.000  0.000                                          
## CD_3     -0.006  0.001  0.000                                   
## PAPmoni   0.033 -0.003 -0.006  0.000                            
## PAPWARM  -0.046 -0.017 -0.023 -0.021  0.000                     
## PAPsolic -0.012  0.004  0.008 -0.005  0.005  0.000              
## PAPrule   0.022  0.016 -0.003  0.068 -0.025 -0.002  0.000       
## PSE      -0.017  0.002 -0.001 -0.017  0.026 -0.001 -0.018  0.000</code></pre>
<pre class="r"><code>fitmeasures(fit1)</code></pre>
<pre><code>##                  npar                  fmin                 chisq 
##                18.000                 0.113                29.756 
##                    df                pvalue        baseline.chisq 
##                18.000                 0.040               306.486 
##           baseline.df       baseline.pvalue                   cfi 
##                28.000                 0.000                 0.958 
##                   tli                  nnfi                   rfi 
##                 0.934                 0.934                 0.849 
##                   nfi                  pnfi                   ifi 
##                 0.903                 0.580                 0.959 
##                   rni                  logl     unrestricted.logl 
##                 0.958              -736.817              -721.939 
##                   aic                   bic                ntotal 
##              1509.634              1561.525               132.000 
##                  bic2                 rmsea        rmsea.ci.lower 
##              1504.591                 0.070                 0.015 
##        rmsea.ci.upper        rmsea.ci.level          rmsea.pvalue 
##                 0.114                 0.900                 0.211 
##        rmsea.close.h0 rmsea.notclose.pvalue     rmsea.notclose.h0 
##                 0.050                 0.393                 0.080 
##                   rmr            rmr_nomean                  srmr 
##                 0.019                 0.019                 0.062 
##          srmr_bentler   srmr_bentler_nomean                  crmr 
##                 0.062                 0.062                 0.070 
##           crmr_nomean            srmr_mplus     srmr_mplus_nomean 
##                 0.070                 0.062                 0.062 
##                 cn_05                 cn_01                   gfi 
##               129.067               155.400                 0.944 
##                  agfi                  pgfi                   mfi 
##                 0.888                 0.472                 0.956 
##                  ecvi 
##                 0.498</code></pre>
<pre class="r"><code>modificationindices(fit1, sort. = TRUE)</code></pre>
<pre><code>##         lhs op      rhs     mi    epc sepc.lv sepc.all sepc.nox
## 45  PAPmoni ~~  PAPrule 17.031  0.091   0.091    0.414    0.414
## 46  PAPWARM ~~ PAPsolic  5.606  0.061   0.061    0.719    0.719
## 47  PAPWARM ~~  PAPrule  5.538 -0.037  -0.037   -0.251   -0.251
## 30     CD_1 ~~  PAPmoni  3.035  0.047   0.047    0.164    0.164
## 43  PAPmoni ~~  PAPWARM  2.681 -0.037  -0.037   -0.191   -0.191
## 31     CD_1 ~~  PAPWARM  2.081 -0.027  -0.027   -0.138   -0.138
## 44  PAPmoni ~~ PAPsolic  1.712 -0.041  -0.041   -0.326   -0.326
## 41     CD_3 ~~ PAPsolic  1.634  0.015   0.015    0.168    0.168
## 22    AdolD =~  PAPWARM  1.603 -0.090  -0.048   -0.108   -0.108
## 40     CD_3 ~~  PAPWARM  1.255 -0.014  -0.014   -0.106   -0.106
## 35     CD_2 ~~  PAPmoni  1.088 -0.020  -0.020   -0.212   -0.212
## 36     CD_2 ~~  PAPWARM  0.985  0.013   0.013    0.206    0.206
## 42     CD_3 ~~  PAPrule  0.784 -0.012  -0.012   -0.081   -0.081
## 34     CD_2 ~~     CD_3  0.676  0.037   0.037    0.561    0.561
## 24    AdolD =~  PAPrule  0.627  0.059   0.032    0.070    0.070
## 33     CD_1 ~~  PAPrule  0.603  0.016   0.016    0.072    0.072
## 32     CD_1 ~~ PAPsolic  0.586 -0.013  -0.013   -0.102   -0.102
## 29     CD_1 ~~     CD_3  0.518 -0.024  -0.024   -0.123   -0.123
## 25  EffectP =~     CD_1  0.409 -0.112  -0.038   -0.050   -0.050
## 48 PAPsolic ~~  PAPrule  0.355 -0.012  -0.012   -0.124   -0.124
## 26  EffectP =~     CD_2  0.280  0.083   0.028    0.045    0.045
## 23    AdolD =~ PAPsolic  0.279  0.042   0.023    0.050    0.050
## 39     CD_3 ~~  PAPmoni  0.137 -0.007  -0.007   -0.034   -0.034
## 38     CD_2 ~~  PAPrule  0.125  0.005   0.005    0.071    0.071
## 37     CD_2 ~~ PAPsolic  0.002  0.000   0.000    0.012    0.012
## 28     CD_1 ~~     CD_2  0.001  0.003   0.003    0.031    0.031
## 27  EffectP =~     CD_3  0.000 -0.002  -0.001   -0.002   -0.002
## 21    AdolD =~  PAPmoni  0.000  0.000   0.000    0.000    0.000</code></pre>
<pre class="r"><code>semPaths(fit1, what=&quot;paths&quot;, whatLables=&quot;par&quot;, rotation=2)</code></pre>
<pre><code>## Warning in qgraph::qgraph(Edgelist, labels = nLab, bidirectional = Bidir, : The
## following arguments are not documented and likely not arguments of qgraph and
## thus ignored: whatLables</code></pre>
<p><img src="p10_files/figure-html/model%20greenish-1.png" width="672" /></p>
<pre class="r"><code>fitmeasures(fit1)</code></pre>
<pre><code>##                  npar                  fmin                 chisq 
##                18.000                 0.113                29.756 
##                    df                pvalue        baseline.chisq 
##                18.000                 0.040               306.486 
##           baseline.df       baseline.pvalue                   cfi 
##                28.000                 0.000                 0.958 
##                   tli                  nnfi                   rfi 
##                 0.934                 0.934                 0.849 
##                   nfi                  pnfi                   ifi 
##                 0.903                 0.580                 0.959 
##                   rni                  logl     unrestricted.logl 
##                 0.958              -736.817              -721.939 
##                   aic                   bic                ntotal 
##              1509.634              1561.525               132.000 
##                  bic2                 rmsea        rmsea.ci.lower 
##              1504.591                 0.070                 0.015 
##        rmsea.ci.upper        rmsea.ci.level          rmsea.pvalue 
##                 0.114                 0.900                 0.211 
##        rmsea.close.h0 rmsea.notclose.pvalue     rmsea.notclose.h0 
##                 0.050                 0.393                 0.080 
##                   rmr            rmr_nomean                  srmr 
##                 0.019                 0.019                 0.062 
##          srmr_bentler   srmr_bentler_nomean                  crmr 
##                 0.062                 0.062                 0.070 
##           crmr_nomean            srmr_mplus     srmr_mplus_nomean 
##                 0.070                 0.062                 0.062 
##                 cn_05                 cn_01                   gfi 
##               129.067               155.400                 0.944 
##                  agfi                  pgfi                   mfi 
##                 0.888                 0.472                 0.956 
##                  ecvi 
##                 0.498</code></pre>
<pre class="r"><code>#looks like the model made by r is uglier than what I got from Amos. I might be stuck with Amos output.</code></pre>
<pre class="r"><code>semPaths(fit1,&quot;std&quot;,layout = &#39;tree&#39;, edge.label.cex=.9, curvePivot = TRUE)</code></pre>
<p><img src="p10_files/figure-html/result-1.png" width="672" /></p>
<pre class="r"><code>library(tidyverse)
library(knitr)
library(lavaan)
library(psych)</code></pre>
<pre><code>## 
## Attaching package: &#39;psych&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lavaan&#39;:
## 
##     cor2cov</code></pre>
<pre><code>## The following objects are masked from &#39;package:ggplot2&#39;:
## 
##     %+%, alpha</code></pre>
<pre class="r"><code>library(MBESS)</code></pre>
<pre><code>## 
## Attaching package: &#39;MBESS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     cor2cov</code></pre>
<pre><code>## The following object is masked from &#39;package:lavaan&#39;:
## 
##     cor2cov</code></pre>
<pre class="r"><code>library(tidyverse)
library(dplyr)
library(haven)
Mother_and_teen_data &lt;- read_sav(&quot;Mother_and_teen_data.sav&quot;)
#View(Mother_and_teen_data)
mt &lt;- Mother_and_teen_data %&gt;% 
 filter(!is.na(Race3)) %&gt;% 
  mutate(ad_deviance=CD_1 + CD_2 + CD_3)
mt$Race3 &lt;- as.factor(mt$Race3)
moderation &lt;- lm(ad_deviance ~ PSE * Race3, mt)
summary(moderation)</code></pre>
<pre><code>## 
## Call:
## lm(formula = ad_deviance ~ PSE * Race3, data = mt)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.3398 -0.9696 -0.2310  0.6918  7.0565 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   7.7566     2.1481   3.611  0.00044 ***
## PSE          -0.4696     0.4435  -1.059  0.29165    
## Race32        2.7934     2.9562   0.945  0.34652    
## Race33        1.6139     2.6591   0.607  0.54499    
## PSE:Race32   -0.6151     0.5891  -1.044  0.29841    
## PSE:Race33   -0.3032     0.5458  -0.556  0.57955    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.53 on 125 degrees of freedom
##   (52 observations deleted due to missingness)
## Multiple R-squared:  0.1408, Adjusted R-squared:  0.1065 
## F-statistic: 4.098 on 5 and 125 DF,  p-value: 0.001765</code></pre>
<pre class="r"><code>moddp &lt;- lm(CD_1 ~ Race3 * PSE, mt)
summary(moddp)</code></pre>
<pre><code>## 
## Call:
## lm(formula = CD_1 ~ Race3 * PSE, data = mt)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.4832 -0.4889 -0.0706  0.4223  2.2039 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   3.9224     1.0317   3.802 0.000223 ***
## Race32       -1.0402     1.4198  -0.733 0.465161    
## Race33        0.6142     1.2771   0.481 0.631406    
## PSE          -0.2994     0.2130  -1.406 0.162273    
## Race32:PSE    0.1618     0.2829   0.572 0.568389    
## Race33:PSE   -0.1277     0.2621  -0.487 0.627054    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.7348 on 125 degrees of freedom
##   (52 observations deleted due to missingness)
## Multiple R-squared:  0.1101, Adjusted R-squared:  0.0745 
## F-statistic: 3.093 on 5 and 125 DF,  p-value: 0.01147</code></pre>
<pre class="r"><code>ggplot(mt, aes(PSE, CD_1, color = factor(Race3))) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;, se = FALSE) +
  scale_color_manual(name = &quot;Race/Ethnicity&quot;, labels = c(&quot;European Americans&quot;, &quot;Latinx&quot;, &quot;African Americans&quot;), values = c(&quot;#FF6666&quot;, &quot;#6666FF&quot;, &quot;green&quot;)) + 
  labs(x=&quot;PSE&quot;, y=&quot;Disobeying Parents&quot;) +
  theme_classic()</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 52 rows containing non-finite values (`stat_smooth()`).</code></pre>
<pre><code>## Warning: Removed 52 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="p10_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<pre class="r"><code># try to test whether race/ethnicity moderates the association between PSE and Disobeying parents (CD_1)
moddp &lt;- lm(CD_1 ~ Race3 * PSE, mt)
summary(moddp)</code></pre>
<pre><code>## 
## Call:
## lm(formula = CD_1 ~ Race3 * PSE, data = mt)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.4832 -0.4889 -0.0706  0.4223  2.2039 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   3.9224     1.0317   3.802 0.000223 ***
## Race32       -1.0402     1.4198  -0.733 0.465161    
## Race33        0.6142     1.2771   0.481 0.631406    
## PSE          -0.2994     0.2130  -1.406 0.162273    
## Race32:PSE    0.1618     0.2829   0.572 0.568389    
## Race33:PSE   -0.1277     0.2621  -0.487 0.627054    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.7348 on 125 degrees of freedom
##   (52 observations deleted due to missingness)
## Multiple R-squared:  0.1101, Adjusted R-squared:  0.0745 
## F-statistic: 3.093 on 5 and 125 DF,  p-value: 0.01147</code></pre>
<pre class="r"><code>ggplot(mt, aes(PSE, CD_1, color = factor(Race3))) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;, se = FALSE) +
  scale_color_manual(name = &quot;Race/Ethnicity&quot;, labels = c(&quot;European Americans&quot;, &quot;Latinx&quot;, &quot;African Americans&quot;), values = c(&quot;#FF6666&quot;, &quot;#6666FF&quot;, &quot;green&quot;)) + 
  labs(x=&quot;PSE&quot;, y=&quot;Disobeying Parents&quot;) +
  theme_classic()</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 52 rows containing non-finite values (`stat_smooth()`).</code></pre>
<pre><code>## Warning: Removed 52 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="p10_files/figure-html/disobeying%20parents-1.png" width="672" /></p>
<pre class="r"><code>#non-significant as well.</code></pre>
<pre class="r"><code># try to test whether race/ethnicity moderates the association between PSE and school misconduct (CD_2)
modsm &lt;- lm(CD_2 ~ Race3 * PSE, mt)
summary(modsm)</code></pre>
<pre><code>## 
## Call:
## lm(formula = CD_2 ~ Race3 * PSE, data = mt)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.8499 -0.4243 -0.1060  0.3152  2.2752 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)  2.68600    0.82911   3.240  0.00153 **
## Race32       1.52259    1.14099   1.334  0.18448   
## Race33       0.43258    1.02631   0.421  0.67412   
## PSE         -0.19717    0.17116  -1.152  0.25153   
## Race32:PSE  -0.30618    0.22738  -1.347  0.18055   
## Race33:PSE  -0.05656    0.21067  -0.268  0.78877   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.5905 on 125 degrees of freedom
##   (52 observations deleted due to missingness)
## Multiple R-squared:  0.1538, Adjusted R-squared:  0.1199 
## F-statistic: 4.543 on 5 and 125 DF,  p-value: 0.0007695</code></pre>
<pre class="r"><code>ggplot(mt, aes(PSE, CD_2, color = factor(Race3))) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;, se = FALSE) +
  scale_color_manual(name = &quot;Race/Ethnicity&quot;, labels = c(&quot;European Americans&quot;, &quot;Latinx&quot;, &quot;African Americans&quot;), values = c(&quot;#FF6666&quot;, &quot;#6666FF&quot;, &quot;green&quot;)) + 
  labs(x=&quot;PSE&quot;, y=&quot;School Misconduct&quot;) +
  theme_classic()</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 52 rows containing non-finite values (`stat_smooth()`).</code></pre>
<pre><code>## Warning: Removed 52 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="p10_files/figure-html/school%20misconduct-1.png" width="672" /></p>
<pre class="r"><code>#non-significant as well.</code></pre>
<pre class="r"><code># try to test whether race/ethnicity moderates the association between PSE and substance uses (CD_3)
modsu &lt;- lm(CD_3 ~ PSE * Race3, mt)
summary(modsu)</code></pre>
<pre><code>## 
## Call:
## lm(formula = CD_3 ~ PSE * Race3, data = mt)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.6562 -0.2679 -0.1750  0.0590  2.5774 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  1.14827    0.66957   1.715   0.0888 .
## PSE          0.02697    0.13822   0.195   0.8456  
## Race32       2.31101    0.92143   2.508   0.0134 *
## Race33       0.56714    0.82882   0.684   0.4951  
## PSE:Race32  -0.47080    0.18362  -2.564   0.0115 *
## PSE:Race33  -0.11895    0.17013  -0.699   0.4857  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4769 on 125 degrees of freedom
##   (52 observations deleted due to missingness)
## Multiple R-squared:  0.1161, Adjusted R-squared:  0.08074 
## F-statistic: 3.284 on 5 and 125 DF,  p-value: 0.008057</code></pre>
<pre class="r"><code>ggplot(mt, aes(PSE, CD_3, color = factor(Race3))) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;, se = FALSE) +
  scale_color_manual(name = &quot;Race/Ethnicity&quot;, labels = c(&quot;European Americans&quot;, &quot;Latinx&quot;, &quot;African Americans&quot;), values = c(&quot;#FF6666&quot;, &quot;#6666FF&quot;, &quot;green&quot;)) + 
  labs(x=&quot;PSE&quot;, y=&quot;Substance Use&quot;) +
  theme_classic()</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 52 rows containing non-finite values (`stat_smooth()`).</code></pre>
<pre><code>## Warning: Removed 52 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="p10_files/figure-html/substance%20use-1.png" width="672" /></p>
<pre class="r"><code>#Race/ethnicity significantly moderates the association between PSE and substance use. PSE negatively associates with substance use for European Americans, but not for the Latinx.
#same results as what I got from SPSS.</code></pre>
<pre class="r"><code>library(tidyverse)
library(dplyr)
library(haven)
teen_survey &lt;- read_sav(&quot;teen_survey.sav&quot;)</code></pre>
<p>#use my thesis data.</p>
<pre class="r"><code>teen_survey$exter&lt;- rowMeans(teen_survey[,c(&quot;Q8_1&quot;, &quot;Q8_2&quot;, &quot;Q8_3&quot;, &quot;Q8_4&quot;, &quot;Q8_5&quot;, &quot;Q8_6&quot;, &quot;Q8_7&quot;, &quot;Q8_8&quot;, &quot;Q8_9&quot;)],
                             na.rm = TRUE)
teen_survey$inter&lt;- rowMeans(teen_survey[,c(&quot;Q9_1&quot;, &quot;Q9_2&quot;, &quot;Q9_3&quot;, &quot;Q9_4&quot;, &quot;Q9_5&quot;, &quot;Q9_6&quot;, &quot;Q9_7&quot;, &quot;Q9_8&quot;, &quot;Q9_9&quot;, &quot;Q9_10&quot;, &quot;Q9_11&quot;, &quot;Q9_12&quot;, &quot;Q9_13&quot;, &quot;Q9_14&quot;)],
                             na.rm = TRUE)
teen_survey$stem&lt;- rowMeans(teen_survey[,c(&quot;Q10_1&quot;, &quot;Q10_2&quot;, &quot;Q10_3&quot;, &quot;Q10_4&quot;, &quot;Q10_5&quot;, &quot;Q10_6&quot;, &quot;Q10_7&quot;, &quot;Q10_8&quot;, &quot;Q10_9&quot;, &quot;Q10_10&quot;, &quot;Q10_11&quot;)],
                             na.rm = TRUE)
teen_survey$pros&lt;- rowMeans(teen_survey[,c(&quot;Q12_1&quot;, &quot;Q12_2&quot;, &quot;Q12_3&quot;, &quot;Q12_4&quot;, &quot;Q12_5&quot;, &quot;Q12_6&quot;, &quot;Q12_7&quot;, &quot;Q12_8&quot;)],
                             na.rm = TRUE)
teen_survey$girl&lt;- rowMeans(teen_survey[,c(&quot;Q14_1&quot;, &quot;Q14_2&quot;, &quot;Q14_3&quot;, &quot;Q14_4&quot;, &quot;Q14_5&quot;)],
                             na.rm = TRUE)
teen_survey$boy&lt;- rowMeans(teen_survey[,c(&quot;Q18_1&quot;, &quot;Q18_2&quot;, &quot;Q18_3&quot;, &quot;Q18_4&quot;, &quot;Q18_5&quot;)],
                             na.rm = TRUE)
teen_survey$ex&lt;- rowMeans(teen_survey[,c(&quot;Q20_1&quot;, &quot;Q20_2&quot;, &quot;Q20_3&quot;, &quot;Q20_4&quot;, &quot;Q20_5&quot;, &quot;Q20_6&quot;, &quot;Q20_7&quot;, &quot;Q20_8&quot;, &quot;Q20_9&quot;)],
                             na.rm = TRUE)
teen_survey$int&lt;- rowMeans(teen_survey[,c(&quot;Q21_1&quot;, &quot;Q21_2&quot;, &quot;Q21_3&quot;, &quot;Q21_4&quot;, &quot;Q21_5&quot;, &quot;Q21_6&quot;, &quot;Q21_7&quot;, &quot;Q21_8&quot;, &quot;Q21_9&quot;, &quot;Q21_10&quot;, &quot;Q21_11&quot;, &quot;Q21_12&quot;, &quot;Q21_13&quot;, &quot;Q21_14&quot;)],
                            na.rm = TRUE)
teen_survey$st&lt;- rowMeans(teen_survey[,c(&quot;Q22_1&quot;, &quot;Q22_2&quot;, &quot;Q22_3&quot;, &quot;Q22_4&quot;, &quot;Q22_5&quot;, &quot;Q22_6&quot;, &quot;Q22_7&quot;, &quot;Q22_8&quot;, &quot;Q22_9&quot;, &quot;Q22_10&quot;, &quot;Q22_11&quot;)],
                             na.rm = TRUE)
teen_survey$pr&lt;- rowMeans(teen_survey[,c(&quot;Q24_1&quot;, &quot;Q24_2&quot;, &quot;Q24_3&quot;, &quot;Q24_4&quot;, &quot;Q24_5&quot;, &quot;Q24_6&quot;, &quot;Q24_7&quot;, &quot;Q24_8&quot;)],
                             na.rm = TRUE)
teen_survey$appe&lt;- rowMeans(teen_survey[,c(&quot;Q25_1&quot;, &quot;Q25_2&quot;, &quot;Q25_3&quot;, &quot;Q25_4&quot;, &quot;Q25_5&quot;, &quot;Q25_6&quot;, &quot;Q25_7&quot;, &quot;Q25_8&quot;, &quot;Q25_9&quot;, &quot;Q25_10&quot;)],
                             na.rm = TRUE)
teen_survey$ind&lt;- rowMeans(teen_survey[,c(&quot;Q26_1&quot;, &quot;Q26_2&quot;, &quot;Q26_3&quot;, &quot;Q26_4&quot;, &quot;Q26_5&quot;, &quot;Q26_6&quot;)],
                             na.rm = TRUE)
teen_survey$dep&lt;- rowMeans(teen_survey[,c(&quot;Q27_1&quot;, &quot;Q27_2&quot;, &quot;Q27_3&quot;, &quot;Q27_4&quot;, &quot;Q27_5&quot;, &quot;Q27_6&quot;)],
                             na.rm = TRUE)
teen_survey$fam&lt;- rowMeans(teen_survey[,c(&quot;Q30_1&quot;, &quot;Q30_2&quot;, &quot;Q30_3&quot;, &quot;Q30_4&quot;, &quot;Q30_5&quot;, &quot;Q30_6&quot;)],
                             na.rm = TRUE)
teen_survey$piety&lt;- rowMeans(teen_survey[,c(&quot;Q31_1&quot;, &quot;Q31_2&quot;, &quot;Q31_3&quot;, &quot;Q31_4&quot;, &quot;Q31_5&quot;, &quot;Q31_6&quot;, &quot;Q31_7&quot;)],
                             na.rm = TRUE)
teen_survey$gen&lt;- rowMeans(teen_survey[,c(&quot;Q32_1&quot;, &quot;Q32_2&quot;, &quot;Q32_3&quot;, &quot;Q32_4&quot;, &quot;Q32_5&quot;, &quot;Q32_6&quot;, &quot;Q32_7&quot;, &quot;Q32_8&quot;, &quot;Q32_9&quot;)],
                             na.rm = TRUE)</code></pre>
<pre class="r"><code>teen_survey$country &lt;- as.factor(teen_survey$country)
teen_survey$Gender &lt;- as.factor(teen_survey$Gender)</code></pre>
<pre class="r"><code>library(lessR)</code></pre>
<pre><code>## 
## lessR 4.2.6                         feedback: gerbing@pdx.edu 
## --------------------------------------------------------------
## &gt; d &lt;- Read(&quot;&quot;)   Read text, Excel, SPSS, SAS, or R data file
##   d is default data frame, data= in analysis routines optional
## 
## Learn about reading, writing, and manipulating data, graphics,
## testing means and proportions, regression, factor analysis,
## customization, and descriptive statistics from pivot tables.
##   Enter:  browseVignettes(&quot;lessR&quot;)
## 
## View changes in this and recent versions of lessR.
##   Enter: news(package=&quot;lessR&quot;)
## 
## **Newly Revised**: Interactive data analysis.
##   Enter: interact()</code></pre>
<pre><code>## 
## Attaching package: &#39;lessR&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:psych&#39;:
## 
##     reflect, rescale, scree, skew</code></pre>
<pre><code>## The following objects are masked from &#39;package:lavaan&#39;:
## 
##     cfa, efa</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     recode, rename</code></pre>
<pre class="r"><code>ts &lt;- teen_survey %&gt;%
  filter(Gender %in% c(&quot;1&quot;, &quot;2&quot;))</code></pre>
<p>#try to use multilevel but it was not correct. the coding was correct
for the function though.</p>
<pre class="r"><code>library(tidyverse)
library(dplyr)
library(haven)
teen_survey&lt;- read_sav(&quot;teen_survey.sav&quot;)
tss&lt;- read_sav(&quot;tss.sav&quot;)
library(lme4)</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## 
## Attaching package: &#39;Matrix&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:tidyr&#39;:
## 
##     expand, pack, unpack</code></pre>
<pre class="r"><code>library(merTools)</code></pre>
<pre><code>## Loading required package: arm</code></pre>
<pre><code>## Loading required package: MASS</code></pre>
<pre><code>## 
## Attaching package: &#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     select</code></pre>
<pre><code>## 
## arm (Version 1.13-1, built: 2022-8-25)</code></pre>
<pre><code>## Working directory is C:/Users/zheqi/OneDrive/Documents/portifolio</code></pre>
<pre><code>## 
## Attaching package: &#39;arm&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lessR&#39;:
## 
##     rescale</code></pre>
<pre><code>## The following objects are masked from &#39;package:psych&#39;:
## 
##     logit, rescale, sim</code></pre>
<pre><code>## 
## Attaching package: &#39;merTools&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:psych&#39;:
## 
##     ICC</code></pre>
<pre class="r"><code>library(semPlot)
library(lavaan)
library(readxl)
library(dplyr)
library(haven)
model1&lt;-lmer(ex~1+(1|exter),REML = FALSE, data=tss)
summary(model1)</code></pre>
<pre><code>## Linear mixed model fit by maximum likelihood  [&#39;lmerMod&#39;]
## Formula: ex ~ 1 + (1 | exter)
##    Data: tss
## 
##      AIC      BIC   logLik deviance df.resid 
##    364.8    374.0   -179.4    358.8      156 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.0350 -0.4304 -0.2328  0.4761  3.2214 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  exter    (Intercept) 0.5116   0.7153  
##  Residual             0.3503   0.5919  
## Number of obs: 159, groups:  exter, 50
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept)   2.1347     0.1179   18.11</code></pre>
<pre class="r"><code>confint(model1)</code></pre>
<pre><code>## Computing profile confidence intervals ...</code></pre>
<pre><code>##                 2.5 %    97.5 %
## .sig01      0.5237991 0.9522256
## .sigma      0.5193724 0.6832228
## (Intercept) 1.9013739 2.3761772</code></pre>
<pre class="r"><code>ICC(outcome = &quot;ex&quot;, group=&quot;exter&quot;,data=tss)</code></pre>
<pre><code>## [1] 0.6017407</code></pre>
<pre class="r"><code>#add level 1 predictor
model2&lt;-lmer(ex~1+Gender+(1|exter), REML= FALSE, data= tss)
summary(model2)</code></pre>
<pre><code>## Linear mixed model fit by maximum likelihood  [&#39;lmerMod&#39;]
## Formula: ex ~ 1 + Gender + (1 | exter)
##    Data: tss
## 
##      AIC      BIC   logLik deviance df.resid 
##    365.4    377.6   -178.7    357.4      155 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.0164 -0.4350 -0.2119  0.4224  3.2329 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  exter    (Intercept) 0.4874   0.6982  
##  Residual             0.3513   0.5927  
## Number of obs: 159, groups:  exter, 50
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept)   1.9206     0.2102   9.138
## Gender        0.1540     0.1272   1.211
## 
## Correlation of Fixed Effects:
##        (Intr)
## Gender -0.835</code></pre>
<pre class="r"><code>anova(model1, model2)</code></pre>
<pre><code>## Data: tss
## Models:
## model1: ex ~ 1 + (1 | exter)
## model2: ex ~ 1 + Gender + (1 | exter)
##        npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)
## model1    3 364.80 374.00 -179.40   358.80                     
## model2    4 365.36 377.63 -178.68   357.36 1.4387  1     0.2304</code></pre>
<pre class="r"><code>confint(model2)</code></pre>
<pre><code>## Computing profile confidence intervals ...</code></pre>
<pre><code>##                   2.5 %    97.5 %
## .sig01       0.50384040 0.9352752
## .sigma       0.51968283 0.6849186
## (Intercept)  1.50168680 2.3438094
## Gender      -0.09814078 0.4090035</code></pre>
<pre class="r"><code>model3&lt;-lmer(ex~1+Gender+(1|exter)+country, REML= FALSE, data= tss)
summary(model3)</code></pre>
<pre><code>## Linear mixed model fit by maximum likelihood  [&#39;lmerMod&#39;]
## Formula: ex ~ 1 + Gender + (1 | exter) + country
##    Data: tss
## 
##      AIC      BIC   logLik deviance df.resid 
##    364.6    379.9   -177.3    354.6      154 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -1.9886 -0.4410 -0.2487  0.4574  3.2441 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  exter    (Intercept) 0.4416   0.6645  
##  Residual             0.3535   0.5946  
## Number of obs: 159, groups:  exter, 50
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept)  2.16573    0.25660   8.440
## Gender       0.08067    0.13498   0.598
## country     -0.22994    0.13590  -1.692
## 
## Correlation of Fixed Effects:
##         (Intr) Gender
## Gender  -0.842       
## country -0.589  0.344</code></pre>
<pre class="r"><code>anova(model2, model3)</code></pre>
<pre><code>## Data: tss
## Models:
## model2: ex ~ 1 + Gender + (1 | exter)
## model3: ex ~ 1 + Gender + (1 | exter) + country
##        npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)  
## model2    4 365.36 377.63 -178.68   357.36                       
## model3    5 364.60 379.94 -177.30   354.60 2.7587  1    0.09672 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>confint(model3)</code></pre>
<pre><code>## Computing profile confidence intervals ...</code></pre>
<pre><code>##                  2.5 %     97.5 %
## .sig01       0.4669502 0.90105804
## .sigma       0.5206961 0.68818660
## (Intercept)  1.6595556 2.67233309
## Gender      -0.1857943 0.34868353
## country     -0.5062512 0.04155505</code></pre>
<pre class="r"><code>#does not think it make any sense statistically.</code></pre>
<pre class="r"><code>model2&lt;-&quot;Parents_expectations=~exter +inter+ pros+ stem
Adolescents_behaviors=~int+ex+pr+st
Parents_expectations~Adolescents_behaviors&quot;
#residual correlations
exter~~inter</code></pre>
<pre><code>## exter ~ ~inter</code></pre>
<pre class="r"><code>pros~~stem</code></pre>
<pre><code>## pros ~ ~stem</code></pre>
<pre class="r"><code>int~~ex</code></pre>
<pre><code>## int ~ ~ex</code></pre>
<pre class="r"><code>pr~~int</code></pre>
<pre><code>## pr ~ ~int</code></pre>
<pre class="r"><code>pr~~ex</code></pre>
<pre><code>## pr ~ ~ex</code></pre>
<pre class="r"><code>st~~pr</code></pre>
<pre><code>## st ~ ~pr</code></pre>
<pre class="r"><code>st~~ex</code></pre>
<pre><code>## st ~ ~ex</code></pre>
<pre class="r"><code>st~~int</code></pre>
<pre><code>## st ~ ~int</code></pre>
<pre class="r"><code>library(lavaan)
library(readxl)
library(dplyr)
library(haven)

fit2&lt;- sem(model2, data=teen_survey)

summary(fit2, standardized=TRUE, ci=TRUE, fit.measures=TRUE)</code></pre>
<pre><code>## lavaan 0.6.14 ended normally after 38 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        17
## 
##                                                   Used       Total
##   Number of observations                           209         234
## 
## Model Test User Model:
##                                                       
##   Test statistic                               288.835
##   Degrees of freedom                                19
##   P-value (Chi-square)                           0.000
## 
## Model Test Baseline Model:
## 
##   Test statistic                               587.554
##   Degrees of freedom                                28
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    0.518
##   Tucker-Lewis Index (TLI)                       0.289
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -2505.911
##   Loglikelihood unrestricted model (H1)      -2361.493
##                                                       
##   Akaike (AIC)                                5045.821
##   Bayesian (BIC)                              5102.641
##   Sample-size adjusted Bayesian (SABIC)       5048.776
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.261
##   90 Percent confidence interval - lower         0.235
##   90 Percent confidence interval - upper         0.288
##   P-value H_0: RMSEA &lt;= 0.050                    0.000
##   P-value H_0: RMSEA &gt;= 0.080                    1.000
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.150
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                            Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower
##   Parents_expectations =~                                              
##     exter                     1.000                               1.000
##     inter                     1.019    0.100   10.184    0.000    0.823
##     pros                      0.112    0.097    1.157    0.247   -0.078
##     stem                      0.348    0.113    3.094    0.002    0.128
##   Adolescents_behaviors =~                                             
##     int                       1.000                               1.000
##     ex                        1.268    0.169    7.503    0.000    0.937
##     pr                        0.450    0.187    2.413    0.016    0.085
##     st                        0.741    0.267    2.779    0.005    0.218
##  ci.upper   Std.lv  Std.all
##                            
##     1.000    1.014    0.794
##     1.215    1.034    0.735
##     0.303    0.114    0.087
##     0.569    0.353    0.232
##                            
##     1.000    0.441    0.553
##     1.599    0.560    0.711
##     0.816    0.199    0.180
##     1.264    0.327    0.209
## 
## Regressions:
##                          Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
##   Parents_expectations ~                                                      
##     Adlscnts_bhvrs          2.483    0.373    6.659    0.000    1.752    3.213
##    Std.lv  Std.all
##                   
##     1.080    1.080
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
##    .exter             0.603    0.094    6.432    0.000    0.419    0.786
##    .inter             0.912    0.117    7.770    0.000    0.682    1.142
##    .pros              1.697    0.166   10.208    0.000    1.371    2.023
##    .stem              2.197    0.217   10.114    0.000    1.771    2.623
##    .int               0.441    0.048    9.215    0.000    0.347    0.535
##    .ex                0.306    0.044    6.937    0.000    0.219    0.392
##    .pr                1.174    0.115   10.178    0.000    0.948    1.400
##    .st                2.335    0.230   10.161    0.000    1.885    2.786
##    .Parnts_xpcttns   -0.172    0.130   -1.325    0.185   -0.426    0.082
##     Adlscnts_bhvrs    0.195    0.049    3.946    0.000    0.098    0.292
##    Std.lv  Std.all
##     0.603    0.369
##     0.912    0.460
##     1.697    0.992
##     2.197    0.946
##     0.441    0.694
##     0.306    0.494
##     1.174    0.967
##     2.335    0.956
##    -0.167   -0.167
##     1.000    1.000</code></pre>
<pre class="r"><code>modindices(fit2, sort.=TRUE)</code></pre>
<pre><code>##                      lhs op   rhs      mi    epc sepc.lv sepc.all sepc.nox
## 49                  stem ~~    st 120.151  1.736   1.736    0.767    0.767
## 37                 inter ~~   int  55.236  0.483   0.483    0.761    0.761
## 31                 exter ~~   int  39.594 -0.391  -0.391   -0.759   -0.759
## 32                 exter ~~    ex  30.210  0.409   0.409    0.952    0.952
## 38                 inter ~~    ex  29.612 -0.415  -0.415   -0.786   -0.786
## 44                  pros ~~    pr  20.716  0.446   0.446    0.316    0.316
## 46                  stem ~~   int   9.380 -0.220  -0.220   -0.223   -0.223
## 41                  pros ~~  stem   9.329  0.410   0.410    0.213    0.213
## 40                 inter ~~    st   7.289 -0.323  -0.323   -0.221   -0.221
## 36                 inter ~~  stem   5.715 -0.268  -0.268   -0.190   -0.190
## 45                  pros ~~    st   4.503  0.294   0.294    0.147    0.147
## 52                   int ~~    st   3.711 -0.141  -0.141   -0.139   -0.139
## 24 Adolescents_behaviors =~ exter   3.136  7.603   3.356    2.627    2.627
## 51                   int ~~    pr   2.627  0.084   0.084    0.116    0.116
## 30                 exter ~~  stem   2.550  0.157   0.157    0.137    0.137
## 29                 exter ~~  pros   2.151 -0.125  -0.125   -0.123   -0.123
## 33                 exter ~~    pr   2.014 -0.106  -0.106   -0.126   -0.126
## 48                  stem ~~    pr   1.559  0.140   0.140    0.087    0.087
## 25 Adolescents_behaviors =~ inter   1.497 -4.797  -2.117   -1.505   -1.505
## 23  Parents_expectations =~    st   0.670 -0.528  -0.535   -0.342   -0.342
## 42                  pros ~~   int   0.574 -0.047  -0.047   -0.055   -0.055
## 53                    ex ~~    pr   0.414 -0.029  -0.029   -0.049   -0.049
## 35                 inter ~~  pros   0.368  0.059   0.059    0.048    0.048
## 43                  pros ~~    ex   0.353 -0.033  -0.033   -0.045   -0.045
## 28                 exter ~~ inter   0.319  0.145   0.145    0.195    0.195
## 34                 exter ~~    st   0.237  0.052   0.052    0.044    0.044
## 54                    ex ~~    st   0.224  0.031   0.031    0.036    0.036
## 21  Parents_expectations =~    ex   0.224  0.646   0.656    0.833    0.833
## 39                 inter ~~    pr   0.192  0.037   0.037    0.036    0.036
## 47                  stem ~~    ex   0.137 -0.024  -0.024   -0.029   -0.029
## 50                   int ~~    ex   0.132  0.022   0.022    0.060    0.060
## 22  Parents_expectations =~    pr   0.123  0.157   0.160    0.145    0.145
## 55                    pr ~~    st   0.109 -0.038  -0.038   -0.023   -0.023
## 27 Adolescents_behaviors =~  stem   0.074 -0.365  -0.161   -0.106   -0.106
## 26 Adolescents_behaviors =~  pros   0.058 -0.276  -0.122   -0.093   -0.093
## 20  Parents_expectations =~   int   0.014  0.091   0.092    0.116    0.116</code></pre>
<pre class="r"><code>inspect(fit2, what=&quot;std&quot;)</code></pre>
<pre><code>## $lambda
##       Prnts_ Adlsc_
## exter  0.794  0.000
## inter  0.735  0.000
## pros   0.087  0.000
## stem   0.232  0.000
## int    0.000  0.553
## ex     0.000  0.711
## pr     0.000  0.180
## st     0.000  0.209
## 
## $theta
##       exter inter  pros  stem   int    ex    pr    st
## exter 0.369                                          
## inter 0.000 0.460                                    
## pros  0.000 0.000 0.992                              
## stem  0.000 0.000 0.000 0.946                        
## int   0.000 0.000 0.000 0.000 0.694                  
## ex    0.000 0.000 0.000 0.000 0.000 0.494            
## pr    0.000 0.000 0.000 0.000 0.000 0.000 0.967      
## st    0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.956
## 
## $psi
##                       Prnts_ Adlsc_
## Parents_expectations  -0.167       
## Adolescents_behaviors  0.000  1.000
## 
## $beta
##                       Prnts_ Adlsc_
## Parents_expectations       0   1.08
## Adolescents_behaviors      0   0.00</code></pre>
<pre class="r"><code>fitmeasures(fit2)</code></pre>
<pre><code>##                  npar                  fmin                 chisq 
##                17.000                 0.691               288.835 
##                    df                pvalue        baseline.chisq 
##                19.000                 0.000               587.554 
##           baseline.df       baseline.pvalue                   cfi 
##                28.000                 0.000                 0.518 
##                   tli                  nnfi                   rfi 
##                 0.289                 0.289                 0.276 
##                   nfi                  pnfi                   ifi 
##                 0.508                 0.345                 0.525 
##                   rni                  logl     unrestricted.logl 
##                 0.518             -2505.911             -2361.493 
##                   aic                   bic                ntotal 
##              5045.821              5102.641               209.000 
##                  bic2                 rmsea        rmsea.ci.lower 
##              5048.776                 0.261                 0.235 
##        rmsea.ci.upper        rmsea.ci.level          rmsea.pvalue 
##                 0.288                 0.900                 0.000 
##        rmsea.close.h0 rmsea.notclose.pvalue     rmsea.notclose.h0 
##                 0.050                 1.000                 0.080 
##                   rmr            rmr_nomean                  srmr 
##                 0.316                 0.316                 0.150 
##          srmr_bentler   srmr_bentler_nomean                  crmr 
##                 0.150                 0.150                 0.170 
##           crmr_nomean            srmr_mplus     srmr_mplus_nomean 
##                 0.170                 0.150                 0.150 
##                 cn_05                 cn_01                   gfi 
##                22.812                27.188                 0.782 
##                  agfi                  pgfi                   mfi 
##                 0.587                 0.413                 0.524 
##                  ecvi 
##                 1.545</code></pre>
<pre class="r"><code>parameterestimates(fit2, standardized = TRUE)</code></pre>
<pre><code>##                      lhs op                   rhs    est    se      z pvalue
## 1   Parents_expectations =~                 exter  1.000 0.000     NA     NA
## 2   Parents_expectations =~                 inter  1.019 0.100 10.184  0.000
## 3   Parents_expectations =~                  pros  0.112 0.097  1.157  0.247
## 4   Parents_expectations =~                  stem  0.348 0.113  3.094  0.002
## 5  Adolescents_behaviors =~                   int  1.000 0.000     NA     NA
## 6  Adolescents_behaviors =~                    ex  1.268 0.169  7.503  0.000
## 7  Adolescents_behaviors =~                    pr  0.450 0.187  2.413  0.016
## 8  Adolescents_behaviors =~                    st  0.741 0.267  2.779  0.005
## 9   Parents_expectations  ~ Adolescents_behaviors  2.483 0.373  6.659  0.000
## 10                 exter ~~                 exter  0.603 0.094  6.432  0.000
## 11                 inter ~~                 inter  0.912 0.117  7.770  0.000
## 12                  pros ~~                  pros  1.697 0.166 10.208  0.000
## 13                  stem ~~                  stem  2.197 0.217 10.114  0.000
## 14                   int ~~                   int  0.441 0.048  9.215  0.000
## 15                    ex ~~                    ex  0.306 0.044  6.937  0.000
## 16                    pr ~~                    pr  1.174 0.115 10.178  0.000
## 17                    st ~~                    st  2.335 0.230 10.161  0.000
## 18  Parents_expectations ~~  Parents_expectations -0.172 0.130 -1.325  0.185
## 19 Adolescents_behaviors ~~ Adolescents_behaviors  0.195 0.049  3.946  0.000
##    ci.lower ci.upper std.lv std.all std.nox
## 1     1.000    1.000  1.014   0.794   0.794
## 2     0.823    1.215  1.034   0.735   0.735
## 3    -0.078    0.303  0.114   0.087   0.087
## 4     0.128    0.569  0.353   0.232   0.232
## 5     1.000    1.000  0.441   0.553   0.553
## 6     0.937    1.599  0.560   0.711   0.711
## 7     0.085    0.816  0.199   0.180   0.180
## 8     0.218    1.264  0.327   0.209   0.209
## 9     1.752    3.213  1.080   1.080   1.080
## 10    0.419    0.786  0.603   0.369   0.369
## 11    0.682    1.142  0.912   0.460   0.460
## 12    1.371    2.023  1.697   0.992   0.992
## 13    1.771    2.623  2.197   0.946   0.946
## 14    0.347    0.535  0.441   0.694   0.694
## 15    0.219    0.392  0.306   0.494   0.494
## 16    0.948    1.400  1.174   0.967   0.967
## 17    1.885    2.786  2.335   0.956   0.956
## 18   -0.426    0.082 -0.167  -0.167  -0.167
## 19    0.098    0.292  1.000   1.000   1.000</code></pre>
<pre class="r"><code>fitted(fit2)</code></pre>
<pre><code>## $cov
##       exter inter  pros  stem   int    ex    pr    st
## exter 1.631                                          
## inter 1.049 1.981                                    
## pros  0.116 0.118 1.710                              
## stem  0.358 0.365 0.040 2.322                        
## int   0.484 0.493 0.054 0.168 0.636                  
## ex    0.613 0.625 0.069 0.214 0.247 0.619            
## pr    0.218 0.222 0.024 0.076 0.088 0.111 1.213      
## st    0.358 0.365 0.040 0.125 0.144 0.183 0.065 2.442</code></pre>
<pre class="r"><code>residuals(fit2)</code></pre>
<pre><code>## $type
## [1] &quot;raw&quot;
## 
## $cov
##        exter  inter   pros   stem    int     ex     pr     st
## exter  0.000                                                 
## inter  0.006  0.000                                          
## pros  -0.085  0.046  0.000                                   
## stem   0.103 -0.204  0.405  0.000                            
## int   -0.127  0.219 -0.045 -0.200  0.000                     
## ex     0.067 -0.096 -0.029 -0.021  0.004  0.000              
## pr    -0.059  0.030  0.442  0.138  0.078 -0.024  0.000       
## st     0.017 -0.245  0.288  1.692 -0.130  0.025 -0.038  0.000</code></pre>
<pre class="r"><code>fitmeasures(fit2)</code></pre>
<pre><code>##                  npar                  fmin                 chisq 
##                17.000                 0.691               288.835 
##                    df                pvalue        baseline.chisq 
##                19.000                 0.000               587.554 
##           baseline.df       baseline.pvalue                   cfi 
##                28.000                 0.000                 0.518 
##                   tli                  nnfi                   rfi 
##                 0.289                 0.289                 0.276 
##                   nfi                  pnfi                   ifi 
##                 0.508                 0.345                 0.525 
##                   rni                  logl     unrestricted.logl 
##                 0.518             -2505.911             -2361.493 
##                   aic                   bic                ntotal 
##              5045.821              5102.641               209.000 
##                  bic2                 rmsea        rmsea.ci.lower 
##              5048.776                 0.261                 0.235 
##        rmsea.ci.upper        rmsea.ci.level          rmsea.pvalue 
##                 0.288                 0.900                 0.000 
##        rmsea.close.h0 rmsea.notclose.pvalue     rmsea.notclose.h0 
##                 0.050                 1.000                 0.080 
##                   rmr            rmr_nomean                  srmr 
##                 0.316                 0.316                 0.150 
##          srmr_bentler   srmr_bentler_nomean                  crmr 
##                 0.150                 0.150                 0.170 
##           crmr_nomean            srmr_mplus     srmr_mplus_nomean 
##                 0.170                 0.150                 0.150 
##                 cn_05                 cn_01                   gfi 
##                22.812                27.188                 0.782 
##                  agfi                  pgfi                   mfi 
##                 0.587                 0.413                 0.524 
##                  ecvi 
##                 1.545</code></pre>
<pre class="r"><code>modificationindices(fit2, sort. = TRUE)</code></pre>
<pre><code>##                      lhs op   rhs      mi    epc sepc.lv sepc.all sepc.nox
## 49                  stem ~~    st 120.151  1.736   1.736    0.767    0.767
## 37                 inter ~~   int  55.236  0.483   0.483    0.761    0.761
## 31                 exter ~~   int  39.594 -0.391  -0.391   -0.759   -0.759
## 32                 exter ~~    ex  30.210  0.409   0.409    0.952    0.952
## 38                 inter ~~    ex  29.612 -0.415  -0.415   -0.786   -0.786
## 44                  pros ~~    pr  20.716  0.446   0.446    0.316    0.316
## 46                  stem ~~   int   9.380 -0.220  -0.220   -0.223   -0.223
## 41                  pros ~~  stem   9.329  0.410   0.410    0.213    0.213
## 40                 inter ~~    st   7.289 -0.323  -0.323   -0.221   -0.221
## 36                 inter ~~  stem   5.715 -0.268  -0.268   -0.190   -0.190
## 45                  pros ~~    st   4.503  0.294   0.294    0.147    0.147
## 52                   int ~~    st   3.711 -0.141  -0.141   -0.139   -0.139
## 24 Adolescents_behaviors =~ exter   3.136  7.603   3.356    2.627    2.627
## 51                   int ~~    pr   2.627  0.084   0.084    0.116    0.116
## 30                 exter ~~  stem   2.550  0.157   0.157    0.137    0.137
## 29                 exter ~~  pros   2.151 -0.125  -0.125   -0.123   -0.123
## 33                 exter ~~    pr   2.014 -0.106  -0.106   -0.126   -0.126
## 48                  stem ~~    pr   1.559  0.140   0.140    0.087    0.087
## 25 Adolescents_behaviors =~ inter   1.497 -4.797  -2.117   -1.505   -1.505
## 23  Parents_expectations =~    st   0.670 -0.528  -0.535   -0.342   -0.342
## 42                  pros ~~   int   0.574 -0.047  -0.047   -0.055   -0.055
## 53                    ex ~~    pr   0.414 -0.029  -0.029   -0.049   -0.049
## 35                 inter ~~  pros   0.368  0.059   0.059    0.048    0.048
## 43                  pros ~~    ex   0.353 -0.033  -0.033   -0.045   -0.045
## 28                 exter ~~ inter   0.319  0.145   0.145    0.195    0.195
## 34                 exter ~~    st   0.237  0.052   0.052    0.044    0.044
## 54                    ex ~~    st   0.224  0.031   0.031    0.036    0.036
## 21  Parents_expectations =~    ex   0.224  0.646   0.656    0.833    0.833
## 39                 inter ~~    pr   0.192  0.037   0.037    0.036    0.036
## 47                  stem ~~    ex   0.137 -0.024  -0.024   -0.029   -0.029
## 50                   int ~~    ex   0.132  0.022   0.022    0.060    0.060
## 22  Parents_expectations =~    pr   0.123  0.157   0.160    0.145    0.145
## 55                    pr ~~    st   0.109 -0.038  -0.038   -0.023   -0.023
## 27 Adolescents_behaviors =~  stem   0.074 -0.365  -0.161   -0.106   -0.106
## 26 Adolescents_behaviors =~  pros   0.058 -0.276  -0.122   -0.093   -0.093
## 20  Parents_expectations =~   int   0.014  0.091   0.092    0.116    0.116</code></pre>
<pre class="r"><code>semPaths(fit2, what=&quot;paths&quot;, whatLables=&quot;par&quot;, rotation=2)</code></pre>
<p><img src="p10_files/figure-html/build%20sem%20model%20for%20thesis-1.png" width="672" /></p>
<pre class="r"><code>fitmeasures(fit2)</code></pre>
<pre><code>##                  npar                  fmin                 chisq 
##                17.000                 0.691               288.835 
##                    df                pvalue        baseline.chisq 
##                19.000                 0.000               587.554 
##           baseline.df       baseline.pvalue                   cfi 
##                28.000                 0.000                 0.518 
##                   tli                  nnfi                   rfi 
##                 0.289                 0.289                 0.276 
##                   nfi                  pnfi                   ifi 
##                 0.508                 0.345                 0.525 
##                   rni                  logl     unrestricted.logl 
##                 0.518             -2505.911             -2361.493 
##                   aic                   bic                ntotal 
##              5045.821              5102.641               209.000 
##                  bic2                 rmsea        rmsea.ci.lower 
##              5048.776                 0.261                 0.235 
##        rmsea.ci.upper        rmsea.ci.level          rmsea.pvalue 
##                 0.288                 0.900                 0.000 
##        rmsea.close.h0 rmsea.notclose.pvalue     rmsea.notclose.h0 
##                 0.050                 1.000                 0.080 
##                   rmr            rmr_nomean                  srmr 
##                 0.316                 0.316                 0.150 
##          srmr_bentler   srmr_bentler_nomean                  crmr 
##                 0.150                 0.150                 0.170 
##           crmr_nomean            srmr_mplus     srmr_mplus_nomean 
##                 0.170                 0.150                 0.150 
##                 cn_05                 cn_01                   gfi 
##                22.812                27.188                 0.782 
##                  agfi                  pgfi                   mfi 
##                 0.587                 0.413                 0.524 
##                  ecvi 
##                 1.545</code></pre>
<pre class="r"><code>#poor fit.</code></pre>
<pre class="r"><code>teen_survey_1&lt;- read_sav(&quot;teen_survey_1.sav&quot;)
gender&lt;-read_sav(&quot;gender.sav&quot;)
#rerun model with the updated dataset
model4&lt;-&quot;Parents_expectations=~exter +inter+ pros+ stem
Adolescents_behaviors=~int+ex+pr+st
Parents_expectations~Adolescents_behaviors&quot;
#residual correlations
exter~~inter</code></pre>
<pre><code>## exter ~ ~inter</code></pre>
<pre class="r"><code>pros~~stem</code></pre>
<pre><code>## pros ~ ~stem</code></pre>
<pre class="r"><code>int~~ex</code></pre>
<pre><code>## int ~ ~ex</code></pre>
<pre class="r"><code>pr~~int</code></pre>
<pre><code>## pr ~ ~int</code></pre>
<pre class="r"><code>pr~~ex</code></pre>
<pre><code>## pr ~ ~ex</code></pre>
<pre class="r"><code>st~~pr</code></pre>
<pre><code>## st ~ ~pr</code></pre>
<pre class="r"><code>st~~ex</code></pre>
<pre><code>## st ~ ~ex</code></pre>
<pre class="r"><code>st~~int</code></pre>
<pre><code>## st ~ ~int</code></pre>
<pre class="r"><code>library(lavaan)
library(readxl)
library(dplyr)
library(haven)

fit4&lt;- sem(model4, data=teen_survey_1)

summary(fit4, standardized=TRUE, ci=TRUE, fit.measures=TRUE)</code></pre>
<pre><code>## lavaan 0.6.14 ended normally after 35 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        17
## 
##                                                   Used       Total
##   Number of observations                           230         255
## 
## Model Test User Model:
##                                                       
##   Test statistic                               338.757
##   Degrees of freedom                                19
##   P-value (Chi-square)                           0.000
## 
## Model Test Baseline Model:
## 
##   Test statistic                               739.134
##   Degrees of freedom                                28
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    0.550
##   Tucker-Lewis Index (TLI)                       0.337
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -2755.501
##   Loglikelihood unrestricted model (H1)      -2586.123
##                                                       
##   Akaike (AIC)                                5545.002
##   Bayesian (BIC)                              5603.450
##   Sample-size adjusted Bayesian (SABIC)       5549.570
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.271
##   90 Percent confidence interval - lower         0.246
##   90 Percent confidence interval - upper         0.296
##   P-value H_0: RMSEA &lt;= 0.050                    0.000
##   P-value H_0: RMSEA &gt;= 0.080                    1.000
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.150
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                            Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower
##   Parents_expectations =~                                              
##     exter                     1.000                               1.000
##     inter                     0.870    0.075   11.554    0.000    0.723
##     pros                      0.083    0.078    1.071    0.284   -0.069
##     stem                      0.379    0.090    4.202    0.000    0.202
##   Adolescents_behaviors =~                                             
##     int                       1.000                               1.000
##     ex                        1.557    0.187    8.318    0.000    1.190
##     pr                        0.354    0.174    2.039    0.041    0.014
##     st                        1.046    0.273    3.836    0.000    0.511
##  ci.upper   Std.lv  Std.all
##                            
##     1.000    1.172    0.853
##     1.018    1.019    0.716
##     0.236    0.098    0.075
##     0.556    0.444    0.290
##                            
##     1.000    0.433    0.549
##     1.924    0.674    0.791
##     0.694    0.153    0.144
##     1.580    0.452    0.280
## 
## Regressions:
##                          Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
##   Parents_expectations ~                                                      
##     Adlscnts_bhvrs          2.846    0.367    7.759    0.000    2.127    3.565
##    Std.lv  Std.all
##                   
##     1.051    1.051
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
##    .exter             0.513    0.090    5.679    0.000    0.336    0.690
##    .inter             0.986    0.110    9.000    0.000    0.771    1.200
##    .pros              1.668    0.156   10.715    0.000    1.363    1.973
##    .stem              2.140    0.202   10.582    0.000    1.743    2.536
##    .int               0.435    0.043    9.999    0.000    0.350    0.520
##    .ex                0.272    0.044    6.185    0.000    0.186    0.358
##    .pr                1.115    0.104   10.699    0.000    0.911    1.319
##    .st                2.403    0.226   10.616    0.000    1.960    2.847
##    .Parnts_xpcttns   -0.143    0.129   -1.112    0.266   -0.396    0.109
##     Adlscnts_bhvrs    0.187    0.044    4.220    0.000    0.100    0.274
##    Std.lv  Std.all
##     0.513    0.272
##     0.986    0.487
##     1.668    0.994
##     2.140    0.916
##     0.435    0.699
##     0.272    0.375
##     1.115    0.979
##     2.403    0.922
##    -0.104   -0.104
##     1.000    1.000</code></pre>
<pre class="r"><code>modindices(fit4, sort.=TRUE)</code></pre>
<pre><code>##                      lhs op   rhs      mi    epc sepc.lv sepc.all sepc.nox
## 49                  stem ~~    st 139.302  1.791   1.791    0.790    0.790
## 37                 inter ~~   int  59.367  0.425   0.425    0.649    0.649
## 31                 exter ~~   int  35.623 -0.345  -0.345   -0.730   -0.730
## 44                  pros ~~    pr  26.438  0.463   0.463    0.340    0.340
## 32                 exter ~~    ex  23.050  0.400   0.400    1.070    1.070
## 38                 inter ~~    ex  22.435 -0.343  -0.343   -0.663   -0.663
## 40                 inter ~~    st  11.614 -0.390  -0.390   -0.253   -0.253
## 46                  stem ~~   int  10.199 -0.212  -0.212   -0.220   -0.220
## 36                 inter ~~  stem   8.817 -0.313  -0.313   -0.215   -0.215
## 41                  pros ~~  stem   6.703  0.325   0.325    0.172    0.172
## 24 Adolescents_behaviors =~ exter   5.330 14.203   6.144    4.474    4.474
## 52                   int ~~    st   4.315 -0.146  -0.146   -0.142   -0.142
## 51                   int ~~    pr   3.741  0.091   0.091    0.131    0.131
## 29                 exter ~~  pros   3.389 -0.143  -0.143   -0.155   -0.155
## 33                 exter ~~    pr   2.679 -0.109  -0.109   -0.144   -0.144
## 45                  pros ~~    st   2.278  0.200   0.200    0.100    0.100
## 35                 inter ~~  pros   2.270  0.138   0.138    0.108    0.108
## 30                 exter ~~  stem   1.884  0.126   0.126    0.120    0.120
## 39                 inter ~~    pr   1.725  0.100   0.100    0.096    0.096
## 21  Parents_expectations =~    ex   1.203  2.012   2.358    2.767    2.767
## 48                  stem ~~    pr   1.108  0.108   0.108    0.070    0.070
## 25 Adolescents_behaviors =~ inter   1.051 -4.168  -1.803   -1.267   -1.267
## 28                 exter ~~ inter   0.748  0.173   0.173    0.244    0.244
## 53                    ex ~~    pr   0.729 -0.035  -0.035   -0.063   -0.063
## 23  Parents_expectations =~    st   0.648 -0.610  -0.714   -0.442   -0.442
## 27 Adolescents_behaviors =~  stem   0.495 -1.255  -0.543   -0.355   -0.355
## 42                  pros ~~   int   0.425 -0.038  -0.038   -0.044   -0.044
## 50                   int ~~    ex   0.412  0.034   0.034    0.098    0.098
## 47                  stem ~~    ex   0.402 -0.037  -0.037   -0.049   -0.049
## 55                    pr ~~    st   0.342 -0.064  -0.064   -0.039   -0.039
## 43                  pros ~~    ex   0.295 -0.027  -0.027   -0.041   -0.041
## 54                    ex ~~    st   0.181  0.027   0.027    0.034    0.034
## 34                 exter ~~    st   0.089  0.030   0.030    0.027    0.027
## 26 Adolescents_behaviors =~  pros   0.014 -0.179  -0.077   -0.060   -0.060
## 20  Parents_expectations =~   int   0.009  0.066   0.078    0.098    0.098
## 22  Parents_expectations =~    pr   0.004  0.032   0.037    0.035    0.035</code></pre>
<pre class="r"><code>inspect(fit4, what=&quot;std&quot;)</code></pre>
<pre><code>## $lambda
##       Prnts_ Adlsc_
## exter  0.853  0.000
## inter  0.716  0.000
## pros   0.075  0.000
## stem   0.290  0.000
## int    0.000  0.549
## ex     0.000  0.791
## pr     0.000  0.144
## st     0.000  0.280
## 
## $theta
##       exter inter  pros  stem   int    ex    pr    st
## exter 0.272                                          
## inter 0.000 0.487                                    
## pros  0.000 0.000 0.994                              
## stem  0.000 0.000 0.000 0.916                        
## int   0.000 0.000 0.000 0.000 0.699                  
## ex    0.000 0.000 0.000 0.000 0.000 0.375            
## pr    0.000 0.000 0.000 0.000 0.000 0.000 0.979      
## st    0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.922
## 
## $psi
##                       Prnts_ Adlsc_
## Parents_expectations  -0.104       
## Adolescents_behaviors  0.000  1.000
## 
## $beta
##                       Prnts_ Adlsc_
## Parents_expectations       0  1.051
## Adolescents_behaviors      0  0.000</code></pre>
<pre class="r"><code>fitmeasures(fit4)</code></pre>
<pre><code>##                  npar                  fmin                 chisq 
##                17.000                 0.736               338.757 
##                    df                pvalue        baseline.chisq 
##                19.000                 0.000               739.134 
##           baseline.df       baseline.pvalue                   cfi 
##                28.000                 0.000                 0.550 
##                   tli                  nnfi                   rfi 
##                 0.337                 0.337                 0.325 
##                   nfi                  pnfi                   ifi 
##                 0.542                 0.368                 0.556 
##                   rni                  logl     unrestricted.logl 
##                 0.550             -2755.501             -2586.123 
##                   aic                   bic                ntotal 
##              5545.002              5603.450               230.000 
##                  bic2                 rmsea        rmsea.ci.lower 
##              5549.570                 0.271                 0.246 
##        rmsea.ci.upper        rmsea.ci.level          rmsea.pvalue 
##                 0.296                 0.900                 0.000 
##        rmsea.close.h0 rmsea.notclose.pvalue     rmsea.notclose.h0 
##                 0.050                 1.000                 0.080 
##                   rmr            rmr_nomean                  srmr 
##                 0.322                 0.322                 0.150 
##          srmr_bentler   srmr_bentler_nomean                  crmr 
##                 0.150                 0.150                 0.170 
##           crmr_nomean            srmr_mplus     srmr_mplus_nomean 
##                 0.170                 0.150                 0.150 
##                 cn_05                 cn_01                   gfi 
##                21.466                25.572                 0.774 
##                  agfi                  pgfi                   mfi 
##                 0.572                 0.409                 0.499 
##                  ecvi 
##                 1.621</code></pre>
<pre class="r"><code>parameterestimates(fit4, standardized = TRUE)</code></pre>
<pre><code>##                      lhs op                   rhs    est    se      z pvalue
## 1   Parents_expectations =~                 exter  1.000 0.000     NA     NA
## 2   Parents_expectations =~                 inter  0.870 0.075 11.554  0.000
## 3   Parents_expectations =~                  pros  0.083 0.078  1.071  0.284
## 4   Parents_expectations =~                  stem  0.379 0.090  4.202  0.000
## 5  Adolescents_behaviors =~                   int  1.000 0.000     NA     NA
## 6  Adolescents_behaviors =~                    ex  1.557 0.187  8.318  0.000
## 7  Adolescents_behaviors =~                    pr  0.354 0.174  2.039  0.041
## 8  Adolescents_behaviors =~                    st  1.046 0.273  3.836  0.000
## 9   Parents_expectations  ~ Adolescents_behaviors  2.846 0.367  7.759  0.000
## 10                 exter ~~                 exter  0.513 0.090  5.679  0.000
## 11                 inter ~~                 inter  0.986 0.110  9.000  0.000
## 12                  pros ~~                  pros  1.668 0.156 10.715  0.000
## 13                  stem ~~                  stem  2.140 0.202 10.582  0.000
## 14                   int ~~                   int  0.435 0.043  9.999  0.000
## 15                    ex ~~                    ex  0.272 0.044  6.185  0.000
## 16                    pr ~~                    pr  1.115 0.104 10.699  0.000
## 17                    st ~~                    st  2.403 0.226 10.616  0.000
## 18  Parents_expectations ~~  Parents_expectations -0.143 0.129 -1.112  0.266
## 19 Adolescents_behaviors ~~ Adolescents_behaviors  0.187 0.044  4.220  0.000
##    ci.lower ci.upper std.lv std.all std.nox
## 1     1.000    1.000  1.172   0.853   0.853
## 2     0.723    1.018  1.019   0.716   0.716
## 3    -0.069    0.236  0.098   0.075   0.075
## 4     0.202    0.556  0.444   0.290   0.290
## 5     1.000    1.000  0.433   0.549   0.549
## 6     1.190    1.924  0.674   0.791   0.791
## 7     0.014    0.694  0.153   0.144   0.144
## 8     0.511    1.580  0.452   0.280   0.280
## 9     2.127    3.565  1.051   1.051   1.051
## 10    0.336    0.690  0.513   0.272   0.272
## 11    0.771    1.200  0.986   0.487   0.487
## 12    1.363    1.973  1.668   0.994   0.994
## 13    1.743    2.536  2.140   0.916   0.916
## 14    0.350    0.520  0.435   0.699   0.699
## 15    0.186    0.358  0.272   0.375   0.375
## 16    0.911    1.319  1.115   0.979   0.979
## 17    1.960    2.847  2.403   0.922   0.922
## 18   -0.396    0.109 -0.104  -0.104  -0.104
## 19    0.100    0.274  1.000   1.000   1.000</code></pre>
<pre class="r"><code>fitted(fit4)</code></pre>
<pre><code>## $cov
##       exter inter  pros  stem   int    ex    pr    st
## exter 1.885                                          
## inter 1.194 2.025                                    
## pros  0.114 0.100 1.677                              
## stem  0.520 0.453 0.043 2.337                        
## int   0.533 0.463 0.044 0.202 0.622                  
## ex    0.829 0.722 0.069 0.314 0.291 0.726            
## pr    0.189 0.164 0.016 0.071 0.066 0.103 1.139      
## st    0.557 0.485 0.046 0.211 0.196 0.305 0.069 2.608</code></pre>
<pre class="r"><code>residuals(fit4)</code></pre>
<pre><code>## $type
## [1] &quot;raw&quot;
## 
## $cov
##        exter  inter   pros   stem    int     ex     pr     st
## exter  0.000                                                 
## inter  0.009  0.000                                          
## pros  -0.088  0.117  0.000                                   
## stem   0.072 -0.259  0.320  0.000                            
## int   -0.099  0.259 -0.036 -0.198  0.000                     
## ex     0.037 -0.077 -0.022 -0.033  0.006  0.000              
## pr    -0.060  0.083  0.461  0.105  0.086 -0.028  0.000       
## st     0.005 -0.318  0.196  1.731 -0.135  0.019 -0.063  0.000</code></pre>
<pre class="r"><code>fitmeasures(fit4)</code></pre>
<pre><code>##                  npar                  fmin                 chisq 
##                17.000                 0.736               338.757 
##                    df                pvalue        baseline.chisq 
##                19.000                 0.000               739.134 
##           baseline.df       baseline.pvalue                   cfi 
##                28.000                 0.000                 0.550 
##                   tli                  nnfi                   rfi 
##                 0.337                 0.337                 0.325 
##                   nfi                  pnfi                   ifi 
##                 0.542                 0.368                 0.556 
##                   rni                  logl     unrestricted.logl 
##                 0.550             -2755.501             -2586.123 
##                   aic                   bic                ntotal 
##              5545.002              5603.450               230.000 
##                  bic2                 rmsea        rmsea.ci.lower 
##              5549.570                 0.271                 0.246 
##        rmsea.ci.upper        rmsea.ci.level          rmsea.pvalue 
##                 0.296                 0.900                 0.000 
##        rmsea.close.h0 rmsea.notclose.pvalue     rmsea.notclose.h0 
##                 0.050                 1.000                 0.080 
##                   rmr            rmr_nomean                  srmr 
##                 0.322                 0.322                 0.150 
##          srmr_bentler   srmr_bentler_nomean                  crmr 
##                 0.150                 0.150                 0.170 
##           crmr_nomean            srmr_mplus     srmr_mplus_nomean 
##                 0.170                 0.150                 0.150 
##                 cn_05                 cn_01                   gfi 
##                21.466                25.572                 0.774 
##                  agfi                  pgfi                   mfi 
##                 0.572                 0.409                 0.499 
##                  ecvi 
##                 1.621</code></pre>
<pre class="r"><code>modificationindices(fit4, sort. = TRUE)</code></pre>
<pre><code>##                      lhs op   rhs      mi    epc sepc.lv sepc.all sepc.nox
## 49                  stem ~~    st 139.302  1.791   1.791    0.790    0.790
## 37                 inter ~~   int  59.367  0.425   0.425    0.649    0.649
## 31                 exter ~~   int  35.623 -0.345  -0.345   -0.730   -0.730
## 44                  pros ~~    pr  26.438  0.463   0.463    0.340    0.340
## 32                 exter ~~    ex  23.050  0.400   0.400    1.070    1.070
## 38                 inter ~~    ex  22.435 -0.343  -0.343   -0.663   -0.663
## 40                 inter ~~    st  11.614 -0.390  -0.390   -0.253   -0.253
## 46                  stem ~~   int  10.199 -0.212  -0.212   -0.220   -0.220
## 36                 inter ~~  stem   8.817 -0.313  -0.313   -0.215   -0.215
## 41                  pros ~~  stem   6.703  0.325   0.325    0.172    0.172
## 24 Adolescents_behaviors =~ exter   5.330 14.203   6.144    4.474    4.474
## 52                   int ~~    st   4.315 -0.146  -0.146   -0.142   -0.142
## 51                   int ~~    pr   3.741  0.091   0.091    0.131    0.131
## 29                 exter ~~  pros   3.389 -0.143  -0.143   -0.155   -0.155
## 33                 exter ~~    pr   2.679 -0.109  -0.109   -0.144   -0.144
## 45                  pros ~~    st   2.278  0.200   0.200    0.100    0.100
## 35                 inter ~~  pros   2.270  0.138   0.138    0.108    0.108
## 30                 exter ~~  stem   1.884  0.126   0.126    0.120    0.120
## 39                 inter ~~    pr   1.725  0.100   0.100    0.096    0.096
## 21  Parents_expectations =~    ex   1.203  2.012   2.358    2.767    2.767
## 48                  stem ~~    pr   1.108  0.108   0.108    0.070    0.070
## 25 Adolescents_behaviors =~ inter   1.051 -4.168  -1.803   -1.267   -1.267
## 28                 exter ~~ inter   0.748  0.173   0.173    0.244    0.244
## 53                    ex ~~    pr   0.729 -0.035  -0.035   -0.063   -0.063
## 23  Parents_expectations =~    st   0.648 -0.610  -0.714   -0.442   -0.442
## 27 Adolescents_behaviors =~  stem   0.495 -1.255  -0.543   -0.355   -0.355
## 42                  pros ~~   int   0.425 -0.038  -0.038   -0.044   -0.044
## 50                   int ~~    ex   0.412  0.034   0.034    0.098    0.098
## 47                  stem ~~    ex   0.402 -0.037  -0.037   -0.049   -0.049
## 55                    pr ~~    st   0.342 -0.064  -0.064   -0.039   -0.039
## 43                  pros ~~    ex   0.295 -0.027  -0.027   -0.041   -0.041
## 54                    ex ~~    st   0.181  0.027   0.027    0.034    0.034
## 34                 exter ~~    st   0.089  0.030   0.030    0.027    0.027
## 26 Adolescents_behaviors =~  pros   0.014 -0.179  -0.077   -0.060   -0.060
## 20  Parents_expectations =~   int   0.009  0.066   0.078    0.098    0.098
## 22  Parents_expectations =~    pr   0.004  0.032   0.037    0.035    0.035</code></pre>
<pre class="r"><code>semPaths(fit4, what=&quot;paths&quot;, whatLables=&quot;par&quot;, rotation=2)</code></pre>
<p><img src="p10_files/figure-html/third%20try%20of%20sem-1.png" width="672" /></p>
<pre class="r"><code>fitmeasures(fit4)</code></pre>
<pre><code>##                  npar                  fmin                 chisq 
##                17.000                 0.736               338.757 
##                    df                pvalue        baseline.chisq 
##                19.000                 0.000               739.134 
##           baseline.df       baseline.pvalue                   cfi 
##                28.000                 0.000                 0.550 
##                   tli                  nnfi                   rfi 
##                 0.337                 0.337                 0.325 
##                   nfi                  pnfi                   ifi 
##                 0.542                 0.368                 0.556 
##                   rni                  logl     unrestricted.logl 
##                 0.550             -2755.501             -2586.123 
##                   aic                   bic                ntotal 
##              5545.002              5603.450               230.000 
##                  bic2                 rmsea        rmsea.ci.lower 
##              5549.570                 0.271                 0.246 
##        rmsea.ci.upper        rmsea.ci.level          rmsea.pvalue 
##                 0.296                 0.900                 0.000 
##        rmsea.close.h0 rmsea.notclose.pvalue     rmsea.notclose.h0 
##                 0.050                 1.000                 0.080 
##                   rmr            rmr_nomean                  srmr 
##                 0.322                 0.322                 0.150 
##          srmr_bentler   srmr_bentler_nomean                  crmr 
##                 0.150                 0.150                 0.170 
##           crmr_nomean            srmr_mplus     srmr_mplus_nomean 
##                 0.170                 0.150                 0.150 
##                 cn_05                 cn_01                   gfi 
##                21.466                25.572                 0.774 
##                  agfi                  pgfi                   mfi 
##                 0.572                 0.409                 0.499 
##                  ecvi 
##                 1.621</code></pre>
<pre class="r"><code>#still not a good fit</code></pre>
<pre class="r"><code>teen_survey_1&lt;- read_sav(&quot;teen_survey_1.sav&quot;)</code></pre>
<pre class="r"><code>ggplot(teen_survey_1, aes(x=exter, y=ex, color = factor(country))) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;, se = FALSE) +
  scale_color_manual(name = &quot;Country&quot;, labels = c(&quot;Americans&quot;, &quot;Chineses&quot;), values = c(&quot;#FF6666&quot;, &quot;#6666FF&quot;)) + 
  labs(x=&quot;Perceived Expectations for Externalizing&quot;, y=&quot;Externalizing&quot;) +
  theme_classic()</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="p10_files/figure-html/graphs-1.png" width="672" /></p>
<pre class="r"><code>ggplot(teen_survey_1, aes(x=inter, y=int, color = factor(country))) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;, se = FALSE) +
  scale_color_manual(name = &quot;Country&quot;, labels = c(&quot;Americans&quot;, &quot;Chineses&quot;), values = c(&quot;#FF6666&quot;, &quot;#6666FF&quot;)) + 
  labs(x=&quot;Perceived Expectations for Internalizing&quot;, y=&quot;Internalizing&quot;) +
  theme_classic()</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="p10_files/figure-html/graphs-2.png" width="672" /></p>
<pre class="r"><code>#looks like the perceived parents&#39; expectations for internalizing predict actual internalizing for Chinese more compared to U.S. adolescents.
ggplot(teen_survey_1, aes(x=stem, y=st, color = factor(country))) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;, se = FALSE) +
  scale_color_manual(name = &quot;Country&quot;, labels = c(&quot;Americans&quot;, &quot;Chineses&quot;), values = c(&quot;#FF6666&quot;, &quot;#6666FF&quot;)) + 
  labs(x=&quot;Perceived Expectations for STEM&quot;, y=&quot;STEM&quot;) +
  theme_classic()</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="p10_files/figure-html/graphs-3.png" width="672" /></p>
<pre class="r"><code>#looks like the perceived parents&#39; expectations for STEM motivations predict actual STEM motivations for Chinese more compared to U.S. adolescents.
#also, the Chinese reported lower perceived expectations for STEM motivations and adolescents&#39; actual STEM motivations.</code></pre>
<pre class="r"><code>ggplot(teen_survey_1, aes(x=pros, y=pr, color = factor(country))) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;, se = FALSE) +
  scale_color_manual(name = &quot;Country&quot;, labels = c(&quot;Americans&quot;, &quot;Chineses&quot;), values = c(&quot;#FF6666&quot;, &quot;#6666FF&quot;)) + 
  labs(x=&quot;Perceived Expectations for prosocial behaviors&quot;, y=&quot;Prosocial behaviors&quot;) +
  theme_classic()</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="p10_files/figure-html/prosocial-1.png" width="672" /></p>
<pre class="r"><code>#visualize gender difference
ggplot(gender, aes(x=exter, y=ex, color = factor(Gender))) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;, se = FALSE) +
  scale_color_manual(name = &quot;Gender&quot;, labels = c(&quot;Girls&quot;, &quot;Boys&quot;), values = c(&quot;#FF6666&quot;, &quot;#6666FF&quot;)) + 
  labs(x=&quot;Perceived Expectations for externalizing&quot;, y=&quot;externalizing&quot;) +
  theme_classic()</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="p10_files/figure-html/ex-1.png" width="672" /></p>
<pre class="r"><code>ggplot(gender, aes(x=inter, y=int, color = factor(Gender))) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;, se = FALSE) +
  scale_color_manual(name = &quot;Gender&quot;, labels = c(&quot;Girls&quot;, &quot;Boys&quot;), values = c(&quot;#FF6666&quot;, &quot;#6666FF&quot;)) + 
  labs(x=&quot;Perceived Expectations for internalizing&quot;, y=&quot;internalizing&quot;) +
  theme_classic()</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="p10_files/figure-html/internalizing-1.png" width="672" /></p>
<pre class="r"><code>ggplot(gender, aes(x=pros, y=pr, color = factor(Gender))) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;, se = FALSE) +
  scale_color_manual(name = &quot;Gender&quot;, labels = c(&quot;Girls&quot;, &quot;Boys&quot;), values = c(&quot;#FF6666&quot;, &quot;#6666FF&quot;)) + 
  labs(x=&quot;Perceived Expectations for prosocial behaviors&quot;, y=&quot;prosocial behaviors&quot;) +
  theme_classic()</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="p10_files/figure-html/prosocial..-1.png" width="672" /></p>
<pre class="r"><code>ggplot(gender, aes(x=stem, y=st, color = factor(Gender))) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;, se = FALSE) +
  scale_color_manual(name = &quot;Gender&quot;, labels = c(&quot;Females&quot;, &quot;Males&quot;), values = c(&quot;#FF6666&quot;, &quot;#6666FF&quot;)) + 
  labs(x=&quot;Perceived Expectations for STEM&quot;, y=&quot;STEM&quot;) +
  theme_classic()</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="p10_files/figure-html/stem.-1.png" width="672" /></p>
<pre class="r"><code>ggplot(gender, aes(x=APPE, y=st, color = factor(Gender))) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;, se = FALSE) +
  scale_color_manual(name = &quot;Gender&quot;, labels = c(&quot;Females&quot;, &quot;Males&quot;), values = c(&quot;#FF6666&quot;, &quot;#6666FF&quot;)) + 
  labs(x=&quot;Perceived parental efficacy&quot;, y=&quot;STEM motivations&quot;) +
  theme_classic()</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="p10_files/figure-html/viausalize%20appe-1.png" width="672" /></p>
<pre class="r"><code>ggplot(gender, aes(x=APPE, y=ex, color = factor(Gender))) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;, se = FALSE) +
  scale_color_manual(name = &quot;Gender&quot;, labels = c(&quot;Females&quot;, &quot;Males&quot;), values = c(&quot;#FF6666&quot;, &quot;#6666FF&quot;)) + 
  labs(x=&quot;Perceived parental efficacy&quot;, y=&quot;externalizing&quot;) +
  theme_classic()</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="p10_files/figure-html/viausalize%20appe-2.png" width="672" /></p>
<pre class="r"><code>ggplot(gender, aes(x=APPE, y=int, color = factor(Gender))) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;, se = FALSE) +
  scale_color_manual(name = &quot;Gender&quot;, labels = c(&quot;Females&quot;, &quot;Males&quot;), values = c(&quot;#FF6666&quot;, &quot;#6666FF&quot;)) + 
  labs(x=&quot;Perceived parental efficacy&quot;, y=&quot;internalizing&quot;) +
  theme_classic()</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="p10_files/figure-html/viausalize%20appe-3.png" width="672" /></p>
<pre class="r"><code>ggplot(gender, aes(x=APPE, y=pr, color = factor(Gender))) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;, se = FALSE) +
  scale_color_manual(name = &quot;Gender&quot;, labels = c(&quot;Females&quot;, &quot;Males&quot;), values = c(&quot;#FF6666&quot;, &quot;#6666FF&quot;)) + 
  labs(x=&quot;Perceived parental efficacy&quot;, y=&quot;prosocial behaviors&quot;) +
  theme_classic()</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="p10_files/figure-html/viausalize%20appe-4.png" width="672" /></p>
<pre class="r"><code>#seems like there were interactions between APPE and gender in intenalizing, externalizing, and prosocial behaviors. 
#girls internalizing and prosocial behavirs were all negatively impacted by APPE, which is interesting. I wonder why that is the case.</code></pre>
<p>#miss the fact that gender and country are dependent of each other
and it was hard to tell that the effects were from gender or country
difference without controlling.</p>
<pre class="r"><code>table(gender$Gender,gender$country)</code></pre>
<pre><code>##    
##       0   1
##   1  28 134
##   2  36  51</code></pre>
<pre class="r"><code>chisq.test(gender$Gender, gender$country, correct=FALSE)</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  gender$Gender and gender$country
## X-squared = 17.209, df = 1, p-value = 0.00003349</code></pre>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
